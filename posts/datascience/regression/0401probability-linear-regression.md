<script> MathJax.Hub.Queue(["Typeset",MathJax.Hub]); </script>

# 확률론적 선형 회귀모형

### Summary

- 부트스트래핑은 회귀분석에 사용한 표본 데이터가 달라질 때 결과가 어느정도 영향을 받는지 알기 위한 방법이다.
- 선형회귀모형의 가정은 가우시안 정규분포를 따르고 잡음의 기댓값은 항상 0이고 표본의 잡음들의 공분산 값도 항상 0이고 표본의 잡음들의 분산은 항상 같다. 
- 단일 계수 t-검정의 귀무가설은 ''가중치가 0이다'' 로 유의확율이 0에 가깝다면 귀무가설은 기각이므로 가중치가 0일 확률이 적다. 두 독립변수의 계수를 비교할 때 쓸 수 있다. 범주형 독립변수의 범주값이 가지는 유의미함을 판단하는데 유용하다. 
- 회귀분석 F-검정의 귀무가설은 ''가중치가 모두 0이다'' 로 유의 확률이 작으면 작을수록 더 강력하게 기각된 것이므로 더 의미가 있는 모형이라고 할 수 있다. 
______

### 부트스트래핑

부트스트래핑(bootstrapping)은 회귀분석에 사용한 표본 데이터가 달라질 때 회귀분석의 결과는 어느 정도 영향을 받는지 알기 위한 방법이다. 

기본의 데이터를 재표본화(re-sampling)하여 여러가지 다양한 표본 데이터 집합을 만드는 방법을 사용한다. 재표본화는 기존의 N개의 데이터에서 다시 N개의 데이터를 선택하되 중복 선택도 가능하게 한다. 

### 확률론적 선형 회귀모형

statsmodels 의 summary 메서드로 출력한 보고서에서 `ste err`이라는 이름으로 표시

#### (1) 선형 정규 분포 가정

선형 회귀분석의 기본 가정은 종속 변수 $$y$$ 가 독립 변수 $$x$$ 의 선형 조합으로 결정되는 기댓값과 고정된 분산 $$\sigma^2$$ 을 가지는 가우시안 정규 분포라는 것이다. 

$$
y ~ N(w^Tx, \sigma^2)
$$

$$y$$ 의 확률 밀도 함수는 다음처럼 쓸 수 있다. 이 식에서 모수 벡터 $$\theta=(w, \sigma^2)$$ 이다.

$$
p(y \mid x, \theta) = \mathcal{N}(y \mid w^Tx, \sigma^2 )
$$

이 관계식을 잡은(disturbance) $$\epsilon$$ 개념으로 변환하면 더 간단하게 표현 할 수 있다.

$$
\epsilon = y - w^Tx\\
p(\epsilon \mid \theta) = \mathcal{N}(0, \sigma^2 )
$$

**x, y 중 어느 것도 그 자체로 정규 분포일 필요는 없다**

y도 x에 대해 조건부로 정규 분포를 이루는 것이다.

#### (2) 외생성(Exogenity) 가정

잡음 $$ϵ$$의 기댓값은 독립 변수 $$x$$의 크기에 상관없이 항상 0이라고 가정한다. 이를 외생성(Exogeneity) 가정이라고 한다.

$$
\text{E}[\epsilon \mid x] = 0
$$

#### (3) 조건부 독립 가정

 $$i$$번째 표본의 잡음 $$ϵ_i$$와 $$j$$번째 표본의 잡음 $$ϵ_j$$의 공분산 값이 $$x$$와 상관없이 항상 0이라고 가정한다.

$$
\text{Cov}[\epsilon_i, \epsilon_j \mid x] = 0 \;\; (i,j=1,2,\ldots,N)
$$

#### (4) 등분산성 가정

- $$i$$번째 표본의 잡음 $$ϵ_i$$와 $$j$$번째 표본의 잡음 $$ϵ_j$$의 분산 값이 표본과 상관없이 항상 같다고 가정한다.

$$
\text{Cov}[\epsilon] = \text{E}[\epsilon^{} \epsilon^T] = \sigma^2I
$$

### 잔차의 분포

**잔차 $$e$$는 잡음 $$ϵ$$의 선형 변환(linear transform)**이다.

**잔차의 기댓값도 x와 상관없이 0이어야 한다.**

### 단일 계수 t-검정(Single Coefficient t-test)

$$
H_0 : w_i = 0 (i = 0, ... , K - 1)
$$

이 검정에 대한 유의 확률이 0에 가깝게 나온다면 위의 귀무가설은 기각이므로 $$w_i$$ 값이 0일 가능성은 적다.

StatsModels `summary` 메서드가 출력하는 회귀분석 보고서에서 `std err`로 표시된 열이 모형계수의 표준오차, `t`로 표시된 열이 단일 계수 t-검정의 검정 통계량, 그리고 `P>|t|`로 표시된 열이 유의확률을 뜻한다.

`RegressionResults` 클래스 객체는 t test 를 위한 `t_test` 메서드를 제공한다. 이 메서드를 사용하면 계수 값이 0이 아닌 경우도 테스트할 수 있다.

단일 계수 t 검정은 두 독립변수의 계수값을 비교할 때도 쓸 수 있다. 그리고 범주형 독립변수의 범주값이 가지는 유의성을 판단하는데 유용하다.

~~~python
print(result_nottem.t_test("C(month)[01] = C(month)[02]"))
~~~

### 회귀분석 F-검정

전체 회귀 계수가 모두 의미가 있는지 확인하는 경우에 사용할 수 있다.

$$
H_0 : w_0 = w_1 = ... = w_{k-1} = 0
$$

이는 전체 독립 변수 중 어느 것도 의미를 가진 것이 없다는 뜻으로 유의 확률이 작으면 작을수록 더 강력하게 기각된 것이므로 더 의미가 있는 모형이라고 할 수 있다. 

여러 모형의 유의 확률을 비교하여 어느 모형이 더 성능이 좋은가를 비교할 때도 이 유의 확률을 사용한다.

보고서에서 `F-statistic`라고 표시된 `400.3`이라는 값이 회귀분석 F-검정의 검정통계량이고 `Prob (F-statistic)`로 표시된 `2.21e-36`라는 값이 유의확률이다.

