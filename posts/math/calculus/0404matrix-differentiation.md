<script> MathJax.Hub.Queue(["Typeset",MathJax.Hub]); </script>

# í–‰ë ¬ì˜ ë¯¸ë¶„

### Summary

- ê·¸ë ˆë””ì–¸íŠ¸(gradient)ëŠ” ìŠ¤ì¹¼ë¼ë¥¼ ë²¡í„°ë¡œ ë¯¸ë¶„í•œ ê°’ì´ë‹¤. ê²°ê³¼ë¥¼ ì—´ë²¡í„°ë¡œ í‘œì‹œí•œë‹¤.
- ì„ í˜• ëª¨í˜•ì„ ë¯¸ë¶„í•˜ë©´ ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ëŠ” ê°€ì¤‘ì¹˜ ë²¡í„°ì´ë‹¤. $$\nabla f = \frac{\partial {w}^{T}{x}}{\partial {x}} = \frac{\partial {x}^{T}{w}}{\partial {x}} = {w}$$
- ì´ì°¨í˜•ì‹ì„ ë¯¸ë¶„í•˜ë©´ í–‰ë ¬ê³¼ ë²¡í„°ì˜ ê³±ìœ¼ë¡œ ë‚˜íƒ€ë‚œë‹¤. $$\nabla f(x) = \frac{\partial {x}^{T}{A}{x}}{\partial {x}} = ({A} + {A}^{T}){x}$$
- í–‰ë ¬ $$A$$ ì™€ ë²¡í„° $$x$$ ì˜ ê³± $$Ax$$ ë¥¼ ë²¡í„° $$x$$ë¡œ ë¯¸ë¶„í•˜ë©´ í–‰ë ¬ $$A^T$$ ê°€ ëœë‹¤. $$\nabla f(x) = \dfrac{\partial ({Ax})}{\partial {x}} = A^T$$
- ìì½”ë¹„ì•ˆ í–‰ë ¬ì€ í•¨ìˆ˜ì˜ ì¶œë ¥ë³€ìˆ˜ì™€ ì…ë ¥ë³€ìˆ˜ ëª¨ë‘ ë²¡í„°ì¸ ê²½ìš° ì…ë ¥ë³€ìˆ˜ ê°ê° ì¶œë ¥ë³€ìˆ˜ ê°ê°ì˜ ì¡°í•©ì— ëŒ€í•´ ë¯¸ë¶„ì´ ì¡´ì¬í•˜ê³  í–‰ë ¬ í˜•íƒœê°€ ëœë‹¤. ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ ë„í•¨ìˆ˜ í–‰ë ¬ì´ë‹¤. ë²¡í„°í•¨ìˆ˜ë¥¼ ë²¡í„°ë³€ìˆ˜ë¡œ ë¯¸ë¶„í•´ì„œ ìƒê¸°ëŠ” í–‰ë ¬ì˜ ì „ì¹˜í–‰ë ¬ì´ë‹¤. 
- ë‹¤ë³€ìˆ˜ í•¨ìˆ˜ì˜ 2ì°¨ ë„í•¨ìˆ˜ëŠ” ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ë¥¼ ì…ë ¥ë³€ìˆ˜ ë²¡í„°ë¡œ ë¯¸ë¶„í•œ ê²ƒìœ¼ë¡œ í—¤ì‹œì•ˆ í–‰ë ¬(Hessian matirx) ì´ë¼ê³  í•œë‹¤. í—¤ì‹œì•ˆ í–‰ë ¬ì€ ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ì˜ ìì½”ë¹„ì•ˆ í–‰ë ¬ì˜ ì „ì¹˜ í–‰ë ¬ë¡œ ì •ì˜í•œë‹¤. 
- ë‘ ì •ë°©í–‰ë ¬ì„ ê³±í•´ì„œ ë§Œë“¤ì–´ì§„ í–‰ë ¬ì˜ ëŒ€ê°ì„±ë¶„(trace)ëŠ” ìŠ¤ì¹¼ë¼ì´ë‹¤. ì´ ìŠ¤ì¹¼ë¼ë¥¼ ë’¤ì˜ í–‰ë ¬ë¡œ ë¯¸ë¶„í•˜ë©´ ì•ì˜ í–‰ë ¬ì˜ ì „ì¹˜í–‰ë ¬ì´ ë‚˜ì˜¨ë‹¤. $$\dfrac{\partial f}{\partial X} =
  \dfrac{\partial \text{tr} ({W}{X})}{\partial {X}} = {W}^T$$
- í–‰ë ¬ì‹(determinant)ì€ ìŠ¤ì¹¼ë¼ ê°’ì´ê³  ì´ ê°’ì˜ ë¡œê·¸ ê°’ë„ ìŠ¤ì¹¼ë¼ì´ë‹¤. ì´ ê°’ì„ ì›ë˜ì˜ í–‰ë ¬ë¡œ ë¯¸ë¶„í•˜ë©´ ì›ë˜ í–‰ë ¬ì˜ ì—­í–‰ë ¬ì˜ ì „ì¹˜ í–‰ë ¬ì´ ëœë‹¤. $$\dfrac{\partial f}{\partial X} = \dfrac{\partial \log | {X} | }{\partial {X}} = ({X}^{-1})^T$$

______________

ì—¬ë ¤ê°œì˜ ì…ë ¥ì„ ê°€ì§€ëŠ” ë‹¤ë³€ìˆ˜ í•¨ìˆ˜ëŠ” í•¨ìˆ˜ì˜ ë…ë¦½ë³€ìˆ˜ê°€ ë²¡í„°ì¸ ê²½ìš°ë¡œ ë³¼ ìˆ˜ ìˆë‹¤.
$$
f\left( \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} \right) = f(x) = f(x_1, x_2)\\
\text{ë²¡í„° } x \;\; \rightarrow \;\; \text{ìŠ¤ì¹¼ë¼ } f
$$

ì´ë¥¼ í™•ì¥í•˜ë©´ í–‰ë ¬ì„ ì…ë ¥ìœ¼ë¡œ ê°€ì§€ëŠ” í•¨ìˆ˜ë„ ìƒê° í•  ìˆ˜ ìˆë‹¤.
$$
f\left( \begin{bmatrix} x_{11} & x_{12} \\ x_{21} & x_{22} \end{bmatrix} \right) 
= f(X) = f(x_{11}, \cdots, x_{22}) \\
\text{í–‰ë ¬ } x \;\; \rightarrow \;\; \text{ìŠ¤ì¹¼ë¼ } f
$$

ë²¡í„°ë‚˜ í–‰ë ¬ì„ ì¶œë ¥í•˜ëŠ” í•¨ìˆ˜ëŠ” ì—¬ëŸ¬ê°œì˜ í•¨ìˆ˜ë¥¼ í•©ì³ ë†“ì€ ê²ƒì´ë‹¤. 
$$
f(x) =
\begin{bmatrix}
f_1(x) \\
f_2(x)
\end{bmatrix} \\
\text{ìŠ¤ì¹¼ë¼ } x \;\; \rightarrow \;\; \text{ë²¡í„° } f\\
f(x) =
\begin{bmatrix}
f_{11}(x) & f_{12}(x) \\
f_{21}(x) & f_{22}(x)
\end{bmatrix} \\
\text{ìŠ¤ì¹¼ë¼ } x \;\; \rightarrow \;\; \text{í–‰ë ¬ } f
$$

ë²¡í„°ë‚˜ í–‰ë ¬ì„ ì…ë ¥ë°›ì•„ ë²¡í„°ë‚˜ í–‰ë ¬ì„ ì¶œë ¥í•  ìˆ˜ë„ ìˆë‹¤.
$$
f(x) =
\begin{bmatrix}
f_1(x_1, x_2) \\
f_2(x_1, x_2)
\end{bmatrix} \\
\text{ë²¡í„° } x \;\; \rightarrow \;\; \text{ë²¡í„° } f \\
f(x) =
\begin{bmatrix}
f_{11}(x_1, x_2) & f_{12}(x_1, x_2) \\
f_{21}(x_1, x_2) & f_{22}(x_1, x_2)
\end{bmatrix} \\
\text{ë²¡í„° } x \;\; \rightarrow \;\; \text{í–‰ë ¬ } f
$$

ì´ëŸ¬í•œ í–‰ë ¬ì„ ì…ë ¥ì´ë‚˜ ì¶œë ¥ìœ¼ë¡œ ê°€ì§€ëŠ” í•¨ìˆ˜ë¥¼ ë¯¸ë¶„í•˜ëŠ” ê²ƒì„ **í–‰ë ¬ë¯¸ë¶„(matrix differentiation)** ì´ë¼ê³  í•œë‹¤.

ì‚¬ì‹¤ í–‰ë ¬ë¯¸ë¶„ì€ ì •í™•í•˜ê²ŒëŠ” ë¯¸ë¶„ì´ ì•„ë‹Œ í¸ë¯¸ë¶„(partial derivative)ì´ì§€ë§Œ ì—¬ê¸°ì—ì„œëŠ” í¸ì˜ìƒ ë¯¸ë¶„ì´ë¼ê³  ì“°ê² ë‹¤. ë˜í•œ í–‰ë ¬ë¯¸ë¶„ì—ëŠ” ë¶„ìì¤‘ì‹¬ í‘œí˜„ë²•(Numerator-layout notation)ê³¼ ë¶„ëª¨ì¤‘ì‹¬ í‘œí˜„ë²•(Denominator-layout notation) ë‘ ê°€ì§€ê°€ ìˆëŠ”ë° ì—¬ê¸°ì—ì„œëŠ” ë¶„ëª¨ì¤‘ì‹¬ í‘œí˜„ë²•ìœ¼ë¡œ ì„œìˆ í•œë‹¤.

### ìŠ¤ì¹¼ë¼ë¥¼ ë²¡í„°ë¡œ ë¯¸ë¶„í•˜ëŠ” ê²½ìš°

ë°ì´í„° ë¶„ì„ì—ì„œëŠ” í•¨ìˆ˜ì˜ ì¶œë ¥ë³€ìˆ˜ê°€ ìŠ¤ì¹¼ë¼ì´ê³  ì…ë ¥ë³€ìˆ˜ ğ‘¥ê°€ ë²¡í„°ì¸ ë‹¤ë³€ìˆ˜ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ë‹¤. ë”°ë¼ì„œ í¸ë¯¸ë¶„ë„ $$\frac{\partial f}{\partial x_1}, \frac{\partial f}{\partial x_2}, \cdots$$ ë“±ìœ¼ë¡œ ì—¬ëŸ¬ ê°œê°€ ì¡´ì¬í•œë‹¤.

ìŠ¤ì¹¼ë¼ë¥¼ ë²¡í„°ë¡œ ë¯¸ë¶„í•˜ëŠ” ê²½ìš°ì—ëŠ” **ê²°ê³¼ë¥¼ ì—´ë²¡í„°**ë¡œ í‘œì‹œí•œë‹¤. ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ ë²¡í„°ë¥¼ **ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°(gradient vector)**ë¼ê³  í•˜ê³  âˆ‡ğ‘“ë¡œ í‘œê¸°í•œë‹¤.
$$
\nabla f = 
\frac{\partial f}{\partial {x}} =
\begin{bmatrix}
\dfrac{\partial f}{\partial x_1}\\
\dfrac{\partial f}{\partial x_2}\\
\vdots\\
\dfrac{\partial f}{\partial x_N}\\
\end{bmatrix}
$$

ì˜ˆì‹œ $$f(x, y) = 2x^2 + 6xy + 7y^2 - 26x - 54y + 107$$  ì— ëŒ€í•œ ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ë¥¼ êµ¬í•˜ë©´ 
$$
\nabla f = 
\begin{bmatrix}
\dfrac{\partial f}{\partial x}\\
\dfrac{\partial f}{\partial y}\\
\end{bmatrix} =
\begin{bmatrix}
4x + 6y - 26\\
6x + 14y - 54\\
\end{bmatrix}
$$

ê·¸ë ˆë””ì–¸íŠ¸ ê¸°í˜¸ë¥¼ ì´ìš©í•˜ë©´ ë‹¤ë³€ìˆ˜ í•¨ìˆ˜ì˜ í…Œì¼ëŸ¬ì „ê°œë¥¼ ë‹¤ìŒì²˜ëŸ¼ ê°„ë‹¨í•˜ê²Œ í‘œì‹œí•  ìˆ˜ ìˆë‹¤.
$$
f(x) \approx f(x_0) + \nabla f(x_0) (x - x_0)
$$

2ì°¨ì›ì˜ ê²½ìš°ë¥¼ ì˜ˆë¡œ ë“¤ì–´ ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ë¥¼ í‘œì‹œí•˜ëŠ” ë²•ì„ ì•Œìë³´ì.

2ê°œì˜ ì…ë ¥ë³€ìˆ˜ë¥¼ ê°€ì§€ëŠ” 2ì°¨ì› í•¨ìˆ˜ ğ‘“(ğ‘¥,ğ‘¦)ëŠ” í‰ë©´ìƒì—ì„œ **ì»¨íˆ¬ì–´(contour)í”Œë¡¯**ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  ì…ë ¥ ë³€ìˆ˜ ğ‘¥,ğ‘¦ ìœ„ì¹˜ì—ì„œì˜ ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„° $$\frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}$$ëŠ” ê·¸ ìœ„ì¹˜ë¥¼ ì›ì ìœ¼ë¡œ í•˜ëŠ” í™”ì‚´í‘œë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ì˜ ë°©í–¥ì€ í¸ë¯¸ë¶„ ì„±ë¶„ $$\frac{\partial f}{\partial x}$$ì™€ $$ \frac{\partial f}{\partial y}$$ì˜ ë¶€í˜¸ì— ì˜í•´ ê²°ì •ëœë‹¤. ë§Œì•½ ì–´ë–¤ ìœ„ì¹˜ ğ‘¥,ğ‘¦ì—ì„œ ğ‘¥ê°€ ì¦ê°€í• ìˆ˜ë¡ ğ‘“ê°€ ì»¤ì§€ë©´ ë„í•¨ìˆ˜ $$\frac{\partial f}{\partial x}$$ì€ ì–‘ìˆ˜ì´ë‹¤. ë°˜ëŒ€ë¡œ ğ‘¦ê°€ ì¦ê°€í• ìˆ˜ë¡ ğ‘“ê°€ ì»¤ì§€ë©´ ë„í•¨ìˆ˜ $$\frac{\partial f}{\partial x}$$ì€ ìŒìˆ˜ì´ë‹¤. ë²¡í„°ëŠ” 2ì°¨ì› í‰ë©´ì—ì„œ í™”ì‚´í‘œë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤. ê°€ë¡œ ì„±ë¶„ì´ ì–‘ìˆ˜ì´ê³  ì„¸ë¡œ ì„±ë¶„ì´ ìŒìˆ˜ì¸ í™”ì‚´í‘œëŠ” ìš°ì¸¡ ì•„ë˜ë¥¼ ê°€ë¦¬í‚¤ëŠ” í™”ì‚´ì´ ë  ê²ƒì´ë‹¤. ì»¨íˆ¬ì–´ í”Œë¡¯ ìœ„ì— ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ë¥¼ í™”ì‚´í‘œë¡œ ë‚˜íƒ€ë‚¸ ê²ƒì„ í”Œë¡¯ì„ **í€´ë²„(quiver)í”Œë¡¯**ì´ë¼ê³  í•œë‹¤. í€´ë²„í”Œë¡¯ì—ì„œ í™”ì‚´í‘œëŠ” í™”ì‚´í‘œ ì‹œì‘ ì§€ì ì˜ ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.

#### í€´ë²„í”Œë¡¯ì—ì„œ ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ì˜ íŠ¹ì§•

ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ì˜ í¬ê¸°ëŠ” ê¸°ìš¸ê¸°ë¥¼ ì˜ë¯¸í•œë‹¤. ì¦‰ ë²¡í„°ì˜ í¬ê°€ê¸° í´ìˆ˜ë¡ í•¨ìˆ˜ ê³¡ë©´ì˜ ê¸°ìš¸ê¸°ê°€ ì»¤ì§„ë‹¤.  ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ì˜ ë°©í–¥ì€ í•¨ìˆ˜ ê³¡ë©´ì˜ ê¸°ìš¸ê¸°ê°€ ê°€ì¥ í° ë°©í–¥, ì¦‰ ë‹¨ìœ„ ê¸¸ì´ë‹¹ í•¨ìˆ˜ê°’(ë†’ì´)ì´ ê°€ì¥ í¬ê²Œ ì¦ê°€í•˜ëŠ” ë°©í–¥ì„ ê°€ë¦¬í‚¨ë‹¤. ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ì˜ ë°©í–¥ì€ ë“±ê³ ì„ (isoline)ì˜ ë°©í–¥ê³¼ ì§êµí•œë‹¤.

ì–´ë–¤ ì  ğ‘¥0ì—ì„œ ë‹¤ë¥¸ ì  ğ‘¥ë¡œ ì´ë™í•˜ë©´ì„œ í•¨ìˆ˜ ê°’ì´ ì–¼ë§ˆë‚˜ ë³€í•˜ëŠ”ì§€ëŠ” í…Œì¼ëŸ¬ ì „ê°œë¥¼ ì¨ì„œ ê·¼ì‚¬í•  ìˆ˜ ìˆë‹¤.
$$
f(x) - f(x_0) = \Delta f \approx  \nabla f(x_0)^T (x - x_0)
$$

ë³€í™”ì˜ ë°©í–¥ $$ğ‘¥âˆ’ğ‘¥_0$$ê°€ ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ì™€ ê°™ì€ ë°©í–¥ì¼ ë•Œ Î”ğ‘“ê°€ ê°€ì¥ ì»¤ì§€ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ë“±ê³ ì„ ì€ ğ‘“(ğ‘¥)ì˜ ê°’ì´ ì¼ ì •í•œ ğ‘¥ì˜ ì§‘í•©ì´ë¯€ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ë°©ì •ì‹ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.
$$
f(x) = f(x_0) \\
f(x) - f(x_0) = 0
$$
ê°™ì€ ë“±ê³ ì„  ìœ„ì˜ ë‹¤ë¥¸ ì  $$ğ‘¥_1$$ë¥¼ í–¥í•´ ì›€ì§ì´ëŠ” ë“±ê³ ì„  ë°©í–¥ì˜ ì›€ì§ì„ì€ $$ğ‘¥_1âˆ’ğ‘¥_0$$ì´ê³  $$ğ‘¥_0$$, $$ğ‘¥_1$$ ëª¨ë‘ ê°™ì€ ë“±ê³ ì„  ìœ„ì˜ ì ì´ë¯€ë¡œ $$ğ‘“(ğ‘¥_0)$$=$$ğ‘“(ğ‘¥_1)$$ì´ë‹¤. ë”°ë¼ì„œ í…Œì¼ëŸ¬ ì „ê°œë¡œë¶€í„° $$\nabla f(x_0)^T (x_1 - x_0) = f(x_1) - f(x_0) = 0$$ ë“±ê³ ì„  ë°©í–¥ $$ğ‘¥_1âˆ’ğ‘¥_0$$ê³¼ $$âˆ‡ğ‘“(ğ‘¥_0)$$ì´ ì§êµí•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.



### í–‰ë ¬ ë¯¸ë¶„ ë²•ì¹™

ë‹¤ë³€ìˆ˜ í•¨ìˆ˜ë¥¼ ë¯¸ë¶„í•˜ì—¬ ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ë¥¼ êµ¬í•  ë•ŒëŠ” ë‹¤ìŒ ë‘ê°€ì§€ ë²•ì¹™ì´ ìœ ìš©í•˜ê²Œ ì“°ì¸ë‹¤. 

#### í–‰ë ¬ ë¯¸ë¶„ ë²•ì¹™ 1: ì„ í˜•ëª¨í˜•

**ì„ í˜• ëª¨í˜•ì„ ë¯¸ë¶„í•˜ë©´ ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ëŠ” ê°€ì¤‘ì¹˜ ë²¡í„°ì´ë‹¤.**
$$
f(x) = w^T x \\
\nabla f = \frac{\partial {w}^{T}{x}}{\partial {x}} = \frac{\partial {x}^{T}{w}}{\partial {x}} = {w}
$$

#### í–‰ë ¬ë¯¸ë¶„ë²•ì¹™ 2: ì´ì°¨í˜•ì‹

**ì´ì°¨í˜•ì‹ì„ ë¯¸ë¶„í•˜ë©´ í–‰ë ¬ê³¼ ë²¡í„°ì˜ ê³±ìœ¼ë¡œ ë‚˜íƒ€ë‚œë‹¤. **
$$
f(x) = x^T A x \\
\nabla f(x) = \frac{\partial {x}^{T}{A}{x}}{\partial {x}} = ({A} + {A}^{T}){x}
$$

##### ë²¡í„°ë¥¼ ìŠ¤ì¹¼ë¼ë¡œ ë¯¸ë¶„í•˜ëŠ” ê²½ìš°

ë²¡í„° $${f}(x) = \begin{bmatrix} f_1 \\ f_2 \\ \vdots\\ f_M \\ \end{bmatrix}$$  ë¥¼ ìŠ¤ì¹¼ë¼ $$x$$ ë¡œ ë¯¸ë¶„í•˜ëŠ” ê²½ìš°ì—ëŠ” ê²°ê³¼ë¥¼ **í–‰ë²¡í„°** ë¡œ í‘œì‹œí•œë‹¤. 
$$
\frac{\partial {f}}{\partial x} = 
\begin{bmatrix}
\dfrac{\partial f_1}{\partial x} &
\dfrac{\partial f_2}{\partial x} &
\cdots &
\dfrac{\partial f_M}{\partial x}
\end{bmatrix}
$$

##### ë²¡í„°ë¥¼ ë²¡í„°ë¡œ ë¯¸ë¶„í•˜ëŠ” ê²½ìš°

ë²¡í„°ë¥¼ ë²¡í„°ë¡œ ë¯¸ë¶„í•˜ë©´ ë¯¸ë¶„ì„ ë‹¹í•˜ëŠ” ë²¡í„°ì˜ ì›ì†Œê°€ ì—¬ëŸ¬ê°œ(ğ‘–=1,â€¦,ğ‘)ì´ê³  ë¯¸ë¶„ì„ í•˜ëŠ” ë²¡í„°ì˜ ì›ì†Œë„ ì—¬ëŸ¬ê°œ(ğ‘—=1,â€¦,ğ‘€)ì´ë¯€ë¡œ ë¯¸ë¶„ì˜ ê²°ê³¼ë¡œ ë‚˜ì˜¨ ë„í•¨ìˆ˜ëŠ” 2ì°¨ì› ë°°ì—´ ì¦‰, í–‰ë ¬ì´ ëœë‹¤.
$$
\dfrac{\partial {f}}{\partial {x}}
= 
\begin{bmatrix}
\dfrac{\partial f_1}{\partial {x}} &
\dfrac{\partial f_2}{\partial {x}} &
\cdots                             & 
\dfrac{\partial f_N}{\partial {x}}
\end{bmatrix}
=
\begin{bmatrix}
\dfrac{\partial {f}}{\partial x_1} \\
\dfrac{\partial {f}}{\partial x_2} \\
\vdots                             \\
\dfrac{\partial {f}}{\partial x_M}
\end{bmatrix}
= 
\begin{bmatrix}
\dfrac{\partial f_1}{\partial x_1} & \dfrac{\partial f_2}{\partial x_1} & \cdots & \dfrac{\partial f_N}{\partial x_1} \\
\dfrac{\partial f_1}{\partial x_2} & \dfrac{\partial f_2}{\partial x_2} & \cdots & \dfrac{\partial f_N}{\partial x_2} \\
\vdots & \vdots & \ddots & \vdots \\
\dfrac{\partial f_1}{\partial x_M} & \dfrac{\partial f_2}{\partial x_M} & \cdots & \dfrac{\partial f_N}{\partial x_M} \\
\end{bmatrix}
$$

#### í–‰ë ¬ë¯¸ë¶„ë²•ì¹™ 3: í–‰ë ¬ê³¼ ë²¡í„°ì˜ ê³±ì˜ ë¯¸ë¶„

**í–‰ë ¬ $$A$$ ì™€ ë²¡í„° $$x$$ ì˜ ê³± $$Ax$$ ë¥¼ ë²¡í„° $$x$$ë¡œ ë¯¸ë¶„í•˜ë©´ í–‰ë ¬ $$A^T$$ ê°€ ëœë‹¤.**
$$
f(x) = Ax \\
\nabla f(x) = \dfrac{\partial ({Ax})}{\partial {x}} = A^T
$$

í•¨ìˆ˜ì˜ ì¶œë ¥ë³€ìˆ˜ì™€ ì…ë ¥ë³€ìˆ˜ê°€ ëª¨ë‘ ë²¡í„°(ë‹¤ì°¨ì›) ë°ì´í„°ì¸ ê²½ìš°ì—ëŠ” ì…ë ¥ë³€ìˆ˜ ê°ê°ê³¼ ì¶œë ¥ë³€ìˆ˜ ê°ê°ì˜ ì¡°í•©ì— ëŒ€í•´ ëª¨ë‘ ë¯¸ë¶„ì´ ì¡´ì¬í•œë‹¤. ë”°ë¼ì„œ ë„í•¨ìˆ˜ëŠ” **í–‰ë ¬** í˜•íƒœê°€ ëœë‹¤. ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ ë„í•¨ìˆ˜ì˜ í–‰ë ¬ì„ **ìì½”ë¹„ì•ˆ í–‰ë ¬(Jacobian matrix)** ì´ë¼ê³  í•œë‹¤. ìì½”ë¹„ì•ˆ í–‰ë ¬ì€ ë²¡í„°í•¨ìˆ˜ë¥¼ ë²¡í„°ë³€ìˆ˜ë¡œ ë¯¸ë¶„í•´ì„œ ìƒê¸°ëŠ” í–‰ë ¬ì˜ **ì „ì¹˜í–‰ë ¬** ì´ë‹¤. ë”°ë¼ì„œ í–‰/ì—´ì˜ ë°©í–¥ì´ ë‹¤ë¥´ë‹¤ëŠ” ì ì— ìœ ì˜í•œë‹¤. 
$$
Jf(x) = J = \left(\frac{\partial  f}{\partial  x}\right)^T = 
\begin{bmatrix}
\left(\dfrac{\partial f_1}{\partial x}\right)^T \\ \vdots \\ \left(\dfrac{\partial f_M}{\partial x}\right)^T 
\end{bmatrix} =
\begin{bmatrix}
\nabla f_1^T \\  \vdots \\ \nabla f_M^T \\ 
\end{bmatrix} =
\begin{bmatrix}
\dfrac{\partial f_1}{\partial x_1} & \cdots & \dfrac{\partial f_1}{\partial x_N}\\
\vdots & \ddots & \vdots\\
\dfrac{\partial f_M}{\partial x_1} & \cdots & \dfrac{\partial f_M}{\partial x_N} 
\end{bmatrix}
$$

ë‹¤ë³€ìˆ˜ í•¨ìˆ˜ì˜ 2ì°¨ ë„í•¨ìˆ˜ëŠ” ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ë¥¼ ì…ë ¥ë³€ìˆ˜ ë²¡í„°ë¡œ ë¯¸ë¶„í•œ ê²ƒìœ¼ë¡œ **í—¤ì‹œì•ˆ í–‰ë ¬(Hessian matirx)** ì´ë¼ê³  í•œë‹¤. í—¤ì‹œì•ˆ í–‰ë ¬ì€ ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ì˜ ìì½”ë¹„ì•ˆ í–‰ë ¬ì˜ ì „ì¹˜ í–‰ë ¬ë¡œ ì •ì˜í•œë‹¤. 
$$
Hf(x) = H = J(\nabla f(x))^T
$$

$$
H_{ij} = \dfrac{\partial^2 f}{\partial x_i\,\partial x_j}
$$

$$
H = \begin{bmatrix}
  \dfrac{\partial^2 f}{\partial x_1^2} & \dfrac{\partial^2 f}{\partial x_1\,\partial x_2} & \cdots & \dfrac{\partial^2 f}{\partial x_1\,\partial x_N} \\
  \dfrac{\partial^2 f}{\partial x_2\,\partial x_1} & \dfrac{\partial^2 f}{\partial x_2^2} & \cdots & \dfrac{\partial^2 f}{\partial x_2\,\partial x_N} \\
  \vdots & \vdots & \ddots & \vdots \\
  \dfrac{\partial^2 f}{\partial x_N\,\partial x_1} & \dfrac{\partial^2 f}{\partial x_N\,\partial x_2} & \cdots & \dfrac{\partial^2 f}{\partial x_N^2}
\end{bmatrix}
$$

**í•¨ìˆ˜ê°€ ì—°ì†ì´ê³  ë¯¸ë¶„ê°€ëŠ¥í•œ í•¨ìˆ˜ë¼ë©´ í—¤ì‹œì•ˆ í–‰ë ¬ì€ ëŒ€ì¹­í–‰ë ¬ì´ ëœë‹¤**

ë²¡í„° -> ìŠ¤ì¹¼ë¼ 

- 1ì°¨ ë¯¸ë¶„ : ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°
- 2ì°¨ ë¯¸ë¶„ : í•´ì‹œì•ˆ í–‰ë ¬

##### ìŠ¤ì¹¼ë¼ë¥¼ í–‰ë ¬ë¡œ ë¯¸ë¶„

ì¶œë ¥ë³€ìˆ˜ $$f$$ ê°€ ìŠ¤ì¹¼ë¼ê°’ì´ê³  ì…ë ¥ë³€ìˆ˜ $$X$$ ê°€ í–‰ë ¬ì¸ ê²½ìš°ì—ëŠ” ë„í•¨ìˆ˜ í–‰ë ¬ì˜ ëª¨ì–‘ì´ ì…ë ¥ë³€ìˆ˜ í–‰ë ¬ $$X$$ ì™€ ê°™ë‹¤. 
$$
\dfrac{\partial f}{\partial {X}} =
\begin{bmatrix}
\dfrac{\partial f}{\partial x_{1,1}} & \dfrac{\partial f}{\partial x_{1,2}} & \cdots & \dfrac{\partial f}{\partial x_{1,N}}\\
\dfrac{\partial f}{\partial x_{2,1}} & \dfrac{\partial f}{\partial x_{2,2}} & \cdots & \dfrac{\partial f}{\partial x_{2,N}}\\
\vdots & \vdots & \ddots & \vdots\\
\dfrac{\partial f}{\partial x_{M,1}} & \dfrac{\partial f}{\partial x_{M,2}} & \cdots & \dfrac{\partial f}{\partial x_{M,N}}\\
\end{bmatrix}
$$

#### í–‰ë ¬ë¯¸ë¶„ë²•ì¹™ 4: í–‰ë ¬ ê³±ì˜ ëŒ€ê°ì„±ë¶„

**ë‘ ì •ë°©í–‰ë ¬ì„ ê³±í•´ì„œ ë§Œë“¤ì–´ì§„ í–‰ë ¬ì˜ ëŒ€ê°ì„±ë¶„(trace)ëŠ” ìŠ¤ì¹¼ë¼ì´ë‹¤. ì´ ìŠ¤ì¹¼ë¼ë¥¼ ë’¤ì˜ í–‰ë ¬ë¡œ ë¯¸ë¶„í•˜ë©´ ì•ì˜ í–‰ë ¬ì˜ ì „ì¹˜í–‰ë ¬ì´ ë‚˜ì˜¨ë‹¤.** 
$$
f(X) = \text{tr} ({W}{X}) \\
({W} \in {R}^{N \times N}, {X} \in {R}^{N \times N}) \\
\dfrac{\partial f}{\partial X} =
\dfrac{\partial \text{tr} ({W}{X})}{\partial {X}} = {W}^T
$$

#### í–‰ë ¬ë¯¸ë¶„ë²•ì¹™ 5 : í–‰ë ¬ì‹ì˜ ë¡œê·¸

**í–‰ë ¬ì‹(determinant)ì€ ìŠ¤ì¹¼ë¼ ê°’ì´ê³  ì´ ê°’ì˜ ë¡œê·¸ ê°’ë„ ìŠ¤ì¹¼ë¼ì´ë‹¤. ì´ ê°’ì„ ì›ë˜ì˜ í–‰ë ¬ë¡œ ë¯¸ë¶„í•˜ë©´ ì›ë˜ í–‰ë ¬ì˜ ì—­í–‰ë ¬ì˜ ì „ì¹˜ í–‰ë ¬ì´ ëœë‹¤. **
$$
f(X) = \log | {X} | \\
\dfrac{\partial f}{\partial X} = \dfrac{\partial \log | {X} | }{\partial {X}} = ({X}^{-1})^T
$$

- (ì¦ëª…) ì—­í–‰ë ¬ ê³„ì‚° ì°¸ê³ 

$$
\begin{align}
A^{-1} = \dfrac{1}{\det (A)} C^T = \dfrac{1}{\det (A)} 
\begin{bmatrix}
C_{1,1} & \cdots & C_{N,1}  \\
\vdots  & \ddots & \vdots   \\
C_{1,N} & \cdots & C_{N,N}  \\
\end{bmatrix}
\tag{2.4.10}
\end{align}
$$

 í–‰ë ¬ì‹ì˜ ì •ì˜ì—ì„œ
$$
\dfrac{\partial}{\partial x_{i,j}} \vert X \vert = C_{i,j}
$$
í–‰ë ¬ì‹ì™€ ì—­í–‰ë ¬ì˜ ê´€ê³„ì—ì„œ
$$
\dfrac{\partial}{\partial X} \vert X \vert = C = | X | (X^{-1})^T
$$
ë¡œê·¸ í•¨ìˆ˜ ê³µì‹ì— ëŒ€ì…í•˜ë©´
$$
\dfrac{d}{dx} \log f(x) = \dfrac{f'(x)}{f(x)} = \dfrac{\vert X \vert (X^{-1})^T}{\vert X \vert} = (X^{-1})^T
$$

___________________________________
###### Reference
ê¹€ë„í˜• ë°•ì‚¬ë‹˜ ê°•ì˜ë¥¼ ìˆ˜ê°•í•˜ë©° ë°ì´í„°ì‚¬ì´ì–¸í‹°ìŠ¤íŠ¸ìŠ¤ì¿¨(https://datascienceschool.net/) ê°•ì˜ìë£Œë¥¼ í† ëŒ€ë¡œ ê³µë¶€í•˜ë©° ì •ë¦¬í•œ ë‚´ìš©ì„ì„ ë§ì”€ë“œë¦½ë‹ˆë‹¤. 