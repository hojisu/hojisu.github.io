<script> MathJax.Hub.Queue(["Typeset",MathJax.Hub]); </script>

# íŠ¹ì‡ê°’ ë¶„í•´ Singular Value Decomposition, SVD

### Summary

- SVDëŠ” ğ‘Ã—ğ‘€í¬ê¸°ì˜ í–‰ë ¬ ğ´ë¥¼ ë‹¤ìŒê³¼ ê°™ì€ 3ê°œì˜ í–‰ë ¬ì˜ ê³±ìœ¼ë¡œ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì´ë‹¤. íŠ¹ì´ê°’, ì™¼ìª½ íŠ¹ì´ë²¡í„°, ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„°ë¡œ ë¶„í•´ ëœë‹¤. 

- ì •ë°©í–‰ë ¬ì´ ì•„ë‹Œ í–‰ë ¬ì€ ê³ ìœ ë¶„í•´ê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ëŒ€ì‹  ê³ ìœ ë¶„í•´ì™€ ë¹„ìŠ·í•œ íŠ¹ì´ë¶„í•´(singular decomposition)ë¥¼ í•  ìˆ˜ ìˆë‹¤.

_____________

### íŠ¹ì‡ê°’ê³¼ íŠ¹ì´ë²¡í„°

$$N$$x$$M$$í¬ê¸°ì˜ í–‰ë ¬ $$A$$ë¥¼ ë‹¤ìŒê³¼ ê°™ì€ 3ê°œì˜ í–‰ë ¬ì˜ ê³±ìœ¼ë¡œ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì„ **íŠ¹ì´ë¶„í•´(singular-decomposition)** ë˜ëŠ” **íŠ¹ì‡ê°’ ë¶„í•´(singular value decomposition)**ë¼ê³  í•œë‹¤.

$$
A = U\Sigma V^T
$$

ì—¬ê¸°ì—ì„œ U, S, VëŠ” ë‹¤ìŒ ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼ í•œë‹¤.

- $$\Sigma \in \mathbf{R}^{N \times M}$$: ëŒ€ê°ì„±ë¶„ì´ ì–‘ìˆ˜ì¸ ëŒ€ê°í–‰ë ¬ì´ì–´ì•¼ í•œë‹¤.**í° ìˆ˜ë¶€í„° ì‘ì€ ìˆ˜ì˜ ìˆœì„œë¡œ ë°°ì—´í•œë‹¤.**
- $$U \in \mathbf{R}^{N \times N}$$: ğ‘Ã—ğ‘ì°¨ì› ì •ë°©í–‰ë ¬. ëª¨ë“  ì—´ë²¡í„°ê°€ ë‹¨ìœ„ë²¡í„°ì´ê³  ì„œë¡œ ì§êµí•´ì•¼ í•œë‹¤.(orthonormal).
- $$V \in \mathbf{R}^{M \times M}$$: ğ‘€Ã—ğ‘€ì°¨ì› ì •ë°©í–‰ë ¬. ëª¨ë“  ì—´ë²¡í„°ê°€ ë‹¨ìœ„ë²¡í„°ì´ê³  ì„œë¡œ ì§êµí•´ì•¼ í•œë‹¤(orthonormal).

ìœ„ ì‹ì„ ë§Œì¡±í•˜ëŠ” í–‰ë ¬ Sì˜ ëŒ€ê°ì„±ë¶„ë“¤ì„ **íŠ¹ì‡ê°’(singular value)**, í–‰ë ¬ Uì˜ ì—´ë²¡í„°ë“¤ì„ **ì™¼ìª½ íŠ¹ì´ë²¡í„°(left singular vector)**, í–‰ë ¬ vì˜ í–‰ë²¡í„°ë“¤ì„ **ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„°(right singular vector)**ë¼ê³  ë¶€ë¥¸ë‹¤.

**íŠ¹ì‡ê°’ì˜ ê°¯ìˆ˜ëŠ” í–‰ë ¬ì˜ ì—´ê³¼ í–‰ì˜ ê°¯ìˆ˜ ì¤‘ ì‘ì€ ê°’ê³¼ ê°™ë‹¤.** íŠ¹ì´ë¶„í•´ëœ í˜•íƒœë¥¼ êµ¬ì²´ì ìœ¼ë¡œ ì“°ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤. 
- ë§Œì•½ ğ‘>ğ‘€ì´ë©´ Î£ í–‰ë ¬ì´ ğ‘€ê°œì˜ íŠ¹ì‡ê°’(ëŒ€ê°ì„±ë¶„)ì„ ê°€ì§€ê³  ë‹¤ìŒì²˜ëŸ¼ ì•„ë« ë¶€ë¶„ì´ 0í–‰ë ¬ì´ ëœë‹¤.

$$
A = 
\begin{bmatrix}
\boxed{\,u_1\!\phantom{\dfrac{\raise 5.5em \mathstrut}{\lower 5.5em \mathstrut}}} \!\!\!\!& 
\boxed{\,u_2\!\phantom{\dfrac{\raise 5.5em \mathstrut}{\lower 5.5em \mathstrut}}} \!\!\!\!& 
\boxed{\,u_3\!\phantom{\dfrac{\raise 5.5em \mathstrut}{\lower 5.5em \mathstrut}}} \!\!\!\!& 
\boxed{\,u_4\!\phantom{\dfrac{\raise 5.5em \mathstrut}{\lower 5.5em \mathstrut}}} \!\!\!\!& 
\cdots \!\!\!\!& 
\boxed{u_N\!\phantom{\dfrac{\raise 5.5em \mathstrut}{\lower 5.5em \mathstrut}}} \!\!\!\!\!\!& 
\end{bmatrix}
\begin{bmatrix}
\boxed{\sigma_1 \phantom{\dfrac{}{}} \!\!} & 0 & 0 & \cdots & 0 \\
0 & \boxed{\sigma_2 \phantom{\dfrac{}{}} \!\!} & 0 & \cdots & 0 \\
0 & 0 & \boxed{\sigma_3 \phantom{\dfrac{}{}} \!\!} & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots \\
0 & 0 & 0 & \cdots & \boxed{\sigma_M \phantom{\dfrac{}{}} \!\!} \\
0 & 0 & 0 & \cdots & 0 \\
\vdots & \vdots & \vdots &  & \vdots \\
0 & 0 & 0 & \cdots & 0 \\
\end{bmatrix}
\begin{bmatrix}
\boxed{\;\;\;\;\;\;\;\; v_1^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;} \\ 
\boxed{\;\;\;\;\;\;\;\; v_2^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;} \\ 
\vdots \\ 
\boxed{\;\;\;\;\;\;\;\; v_M^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;} \\ 
\end{bmatrix}
$$

- ë°˜ëŒ€ë¡œ ğ‘<ğ‘€ì´ë©´ Î£ í–‰ë ¬ì´ ğ‘ê°œì˜ íŠ¹ì‡ê°’(ëŒ€ê°ì„±ë¶„)ì„ ê°€ì§€ê³  ë‹¤ìŒì²˜ëŸ¼ ì˜¤ë¥¸ìª½ ë¶€ë¶„ì´ 0í–‰ë ¬ì´ ëœë‹¤.

$$
A = 
\begin{bmatrix}
\boxed{\,u_1\!\phantom{\dfrac{\raise 2em \mathstrut}{\lower 2em \mathstrut}}} \!\!\!\!& 
\boxed{\,u_2\!\phantom{\dfrac{\raise 2em \mathstrut}{\lower 2em \mathstrut}}} \!\!\!\!& 
\cdots \!\!\!\!& 
\boxed{u_N\!\phantom{\dfrac{\raise 2em \mathstrut}{\lower 2em \mathstrut}}} \!\!\!\!\!\!& 
\end{bmatrix}
\begin{bmatrix}
\boxed{\sigma_1 \phantom{\dfrac{}{}} \!\!} & 0 & 0 & \cdots & 0 & 0 & \cdots & 0 \\
0 & \boxed{\sigma_2 \phantom{\dfrac{}{}} \!\!} & 0 & \cdots & 0 & 0 & \cdots & 0 \\
0 & 0 & \boxed{\sigma_3 \phantom{\dfrac{}{}} \!\!} & \cdots & 0 & 0 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots & & \vdots \\
0 & 0 & 0 & \cdots & \boxed{\sigma_N \phantom{\dfrac{}{}} \!\!} & 0 & \cdots & 0 \\
\end{bmatrix}
\begin{bmatrix}
\boxed{\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\; v_1^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;} \\ 
\boxed{\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\; v_2^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;} \\ 
\boxed{\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\; v_3^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;} \\ 
\boxed{\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\; v_4^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;} \\ 
\vdots \\ 
\boxed{\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\; v_M^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;} \\ 
\end{bmatrix}
$$

- í–‰ë ¬ì˜ í¬ê¸°ë§Œ í‘œì‹œí•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.
    - N>M ì¼ ê²½ìš°
    $$
    N\left\{\phantom{\raise 3em \mathstrut\!}\right.
    \overbrace{
    \boxed{
    \raise 3.5em 
    \hspace 2ex A \hspace 2ex
    \lower 3em {}
    }}^{\large M}
    =
    N\left\{\phantom{\raise 3em \mathstrut\!}\right.
    \overbrace{
    \boxed{
    \raise 3.5em 
    \hspace 6.5ex U \hspace 7ex
    \lower 3em {}
    }}^{\large N}
    \overbrace{
    \boxed{
    \raise 3.5em 
    \hspace 2ex \Sigma \hspace 2ex
    \lower 3em {}
    }}^{\large M}
    \overbrace{
    \boxed{
    \raise 1.2em 
    \hspace 1.6ex V \hspace 2ex
    \lower 0.8em {}
    }}^{\large M}
    \!\!\left.\phantom{\raise 0.8em \mathstrut}\right\}M
    $$

    - M>N ì¼ ê²½ìš°
    $$
    N\left\{\phantom{\raise 0.8em \mathstrut\!}\right.
    \overbrace{
    \boxed{
    \raise 1.2em 
    \hspace 6.5ex A \hspace 7ex
    \lower 0.8em {}
    }}^{\large M}
    =
    N\left\{\phantom{\raise 0.8em \mathstrut\!}\right.
    \overbrace{
    \boxed{
    \raise 1.2em 
    \hspace 1.6ex U \hspace 2ex
    \lower 0.8em {}
    }}^{\large N}
    \overbrace{
    \boxed{
    \raise 1.2em 
    \hspace 8ex \Sigma \hspace 8ex
    \lower 0.8em {}
    }}^{\large M}
    \overbrace{
    \boxed{
    \raise 3.5em 
    \hspace 6.5ex V \hspace 7ex
    \lower 3em {}
    }}^{\large M}
    \!\left.\phantom{\raise 3em \mathstrut}\right\}M
    $$

- ì˜ˆë¥¼ ë“¤ì–´ í–‰ë ¬ AëŠ” ë‹¤ìŒì²˜ëŸ¼ íŠ¹ì´ë¶„í•´ í•  ìˆ˜ ìˆë‹¤.
  $$
  A = 
  \begin{bmatrix}
  3 & -1 \\
  1 & 3 \\
  1 & 1
  \end{bmatrix}
  $$

  $$
  A = 
  \begin{bmatrix}
   -\frac{1}{\sqrt{6}} &  \frac{2}{\sqrt{5}} & -\frac{1}{\sqrt{6}} \\ 
   -\frac{2}{\sqrt{6}} & -\frac{1}{\sqrt{5}} &  -\frac{2}{\sqrt{30}} \\ 
   -\frac{1}{\sqrt{6}} & 0 &  \frac{5}{\sqrt{30}}
  \end{bmatrix}
  \begin{bmatrix}
  \sqrt{12} & 0        \\
         0  & \sqrt{10} \\
         0 & 0 
  \end{bmatrix}
  \begin{bmatrix}
  -\frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} \\
   \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} 
  \end{bmatrix}
  $$


### íŠ¹ì´ê°’ ë¶„í•´ì˜ ì¶•ì†Œí˜•

**íŠ¹ì‡ê°’ ëŒ€ê°í–‰ë ¬**ì—ì„œ **0ì¸ ë¶€ë¶„ì€ ì‚¬ì‹¤ìƒ ì•„ë¬´ëŸ° ì˜ë¯¸ê°€ ì—†ê¸° ë•Œë¬¸ì—** **ëŒ€ê°í–‰ë ¬ì˜ 0 ì›ì†Œë¶€ë¶„ê³¼ ì´ì— ëŒ€ì‘í•˜ëŠ” ì™¼ìª½(í˜¹ì€ ì˜¤ë¥¸ìª½) íŠ¹ì´ë²¡í„°ë“¤ì„ ì—†ì• **ê³  ë‹¤ìŒì²˜ëŸ¼ **ì¶•ì†Œëœ í˜•íƒœ**ë¡œ í•´ë„ ë§ˆì°¬ê°€ì§€ë¡œ **ì›ë˜ì˜ í–‰ë ¬ì´ ë‚˜ì˜¨ë‹¤.**

- N > M ì¼ ê²½ìš°, ì™¼ìª½(U) íŠ¹ì´ë²¡í„° ì¤‘ì—ì„œ  $$ğ‘¢_{ğ‘€+1},â‹¯,ğ‘¢_ğ‘$$ì„ ì—†ì•¤ë‹¤.

$$
A = 
\begin{bmatrix}
\boxed{\,u_1\!\phantom{\dfrac{\raise 3em \mathstrut}{\lower 3em \mathstrut}}} \!\!\!\!& 
\boxed{\,u_2\!\phantom{\dfrac{\raise 3em \mathstrut}{\lower 3em \mathstrut}}} \!\!\!\!& 
\cdots \!\!\!\!& 
\boxed{\,u_M\!\phantom{\dfrac{\raise 3em \mathstrut}{\lower 3em \mathstrut}}} \!\!\!\!& 
\end{bmatrix}
\begin{bmatrix}
\boxed{\sigma_1 \phantom{\dfrac{}{}} \!\!} & 0 & 0 & \cdots & 0 \\
0 & \boxed{\sigma_2 \phantom{\dfrac{}{}} \!\!} & 0 & \cdots & 0 \\
0 & 0 & \boxed{\sigma_3 \phantom{\dfrac{}{}} \!\!} & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots \\
0 & 0 & 0 & \cdots & \boxed{\sigma_M \phantom{\dfrac{}{}} \!\!} \\
\end{bmatrix}
\begin{bmatrix}
\boxed{\;\;\;\;\;\;\;\; v_1^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;} \\ 
\boxed{\;\;\;\;\;\;\;\; v_2^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;} \\ 
\vdots \\ 
\boxed{\;\;\;\;\;\;\;\; v_M^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;} \\ 
\end{bmatrix}
$$

- M > N ì¼ ê²½ìš°, ì˜¤ë¥¸ìª½(V^T) íŠ¹ì´ë²¡í„° ì¤‘ì—ì„œ $$ğ‘£_{ğ‘+1},â‹¯,ğ‘£_ğ‘€$$ì„ ì—†ì•¤ë‹¤.

$$
A = 
\begin{bmatrix}
\boxed{\,u_1\!\phantom{\dfrac{\raise 2em \mathstrut}{\lower 2em \mathstrut}}} \!\!\!\!& 
\boxed{\,u_2\!\phantom{\dfrac{\raise 2em \mathstrut}{\lower 2em \mathstrut}}} \!\!\!\!& 
\cdots \!\!\!\!& 
\boxed{u_N\!\phantom{\dfrac{\raise 2em \mathstrut}{\lower 2em \mathstrut}}} \!\!\!\!\!\!& 
\end{bmatrix}
\begin{bmatrix}
\boxed{\sigma_1 \phantom{\dfrac{}{}} \!\!} & 0 & 0 & \cdots & 0  \\
0 & \boxed{\sigma_2 \phantom{\dfrac{}{}} \!\!} & 0 & \cdots & 0 \\
0 & 0 & \boxed{\sigma_3 \phantom{\dfrac{}{}} \!\!} & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots   \\
0 & 0 & 0 & \cdots & \boxed{\sigma_N \phantom{\dfrac{}{}} \!\!}  \\
\end{bmatrix}
\begin{bmatrix}
\boxed{\;\;\;\;\;\;\;\;\;\;\;\;\; v_1^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;\;\;\;\;\;} \\ 
\boxed{\;\;\;\;\;\;\;\;\;\;\;\;\; v_2^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;\;\;\;\;\;} \\ 
\vdots \\ 
\boxed{\;\;\;\;\;\;\;\;\;\;\;\;\; v_N^T \lower 0.3em \mathstrut \;\;\;\;\;\;\;\;\;\;\;\;\;} \\ 
\end{bmatrix}
$$

- ì¶•ì†Œí˜•ì˜ ê²½ìš°ë¥¼ í–‰ë ¬ì˜ í¬ê¸°ë§Œ í‘œì‹œí•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

  - N > M

  $$
  N\left\{\phantom{\raise 3em \mathstrut\!}\right.
  \overbrace{
  \boxed{
  \raise 3.5em 
  \hspace 2ex A \hspace 2ex
  \lower 3em {}
  }}^{\large M}
  =
  N\left\{\phantom{\raise 3em \mathstrut\!}\right.
  \overbrace{
  \boxed{
  \raise 3.5em 
  \hspace 2ex U \hspace 2ex
  \lower 3em {}
  }}^{\large M}
  \overbrace{
  \boxed{
  \raise 1.2em 
  \hspace 1.6ex \Sigma \hspace 2ex
  \lower 0.8em {}
  }}^{\large M}
  \overbrace{
  \boxed{
  \raise 1.2em 
  \hspace 1.6ex V \hspace 2ex
  \lower 0.8em {}
  }}^{\large M}
  \!\!\left.\phantom{\raise 0.8em \mathstrut}\right\}M
  $$

  

  - M > N

$$
N\left\{\phantom{\raise 0.8em \mathstrut\!}\right.
\overbrace{
\boxed{
\raise 1.2em 
\hspace 6.5ex A \hspace 7ex
\lower 0.8em {}
}}^{\large M}
=
N\left\{\phantom{\raise 0.8em \mathstrut\!}\right.
\overbrace{
\boxed{
\raise 1.2em 
\hspace 1.6ex U \hspace 2ex
\lower 0.8em {}
}}^{\large N}
\overbrace{
\boxed{
\raise 1.2em 
\hspace 1.6ex \Sigma \hspace 2ex
\lower 0.8em {}
}}^{\large N}
\overbrace{
\boxed{
\raise 1.2em 
\hspace 6.5ex V \hspace 7ex
\lower 0.8em {}
}}^{\large M}
\!\left.\phantom{\raise 0.8em \mathstrut}\right\}N
$$

- ì˜ˆë¥¼ ë“¤ì–´ í–‰ë ¬ Aì˜ íŠ¹ì´ë¶„í•´ ì¶•ì†Œí˜•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
  $$
  A = 
  \begin{bmatrix}
   -\frac{1}{\sqrt{6}} &  \frac{2}{\sqrt{5}} \\ 
   -\frac{2}{\sqrt{6}} & -\frac{1}{\sqrt{5}} \\ 
   -\frac{1}{\sqrt{6}} & 0 
  \end{bmatrix}
  \begin{bmatrix}
  \sqrt{12} & 0        \\
         0  & \sqrt{10} \\
  \end{bmatrix}
  \begin{bmatrix}
  -\frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} \\
   \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} 
  \end{bmatrix}
  $$


### íŠ¹ì´ë¶„í•´ì˜ ì¡´ì¬

ì´ëŸ¬í•œ íŠ¹ì´ë¶„í•´ëŠ” ëª¨ë“  í–‰ë ¬ì— ëŒ€í•´ ê°€ëŠ¥í•˜ë‹¤. ì¦‰ **ì–´ë–¤ í–‰ë ¬ì´ ì£¼ì–´ì§€ë”ë¼ë„ ìœ„ì™€ ê°™ì´ íŠ¹ì´ë¶„í•´í•  ìˆ˜ ìˆë‹¤.** 


### íŒŒì´ì¬ì„ ì‚¬ìš©í•œ íŠ¹ì´ë¶„í•´

numpy.linalg ì„œë¸ŒíŒ¨í‚¤ì§€ì™€ scipy.linalg ì„œë¸ŒíŒ¨í‚¤ì§€ì—ì„œëŠ” íŠ¹ì´ë¶„í•´ë¥¼ í•  ìˆ˜ ìˆëŠ” `svd`ëª…ë ¹ì„ ì œê³µí•œë‹¤. **ì˜¤ë¥¸ìª½ íŠ¹ì´í–‰ë ¬ì€ ì „ì¹˜í–‰ë ¬ë¡œ ì¶œë ¥**ëœë‹¤ëŠ” ì ì— ì£¼ì˜í•˜ë¼.

~~~python
from numpy.linalg import svd

A = np.array([[3, -1], [1, 3], [1, 1]])
U, S, VT = svd(A)
~~~

~~~python
U
~~~

~~~
# Uì˜ (ì™¼ìª½ íŠ¹ì´ë²¡í„°)
array([[-4.08248290e-01,  8.94427191e-01, -1.82574186e-01],
       [-8.16496581e-01, -4.47213595e-01, -3.65148372e-01],
       [-4.08248290e-01, -2.06937879e-16,  9.12870929e-01]])
~~~

~~~python
S
~~~

~~~~
# Sì˜ (íŠ¹ì‡ê°’)
array([3.46410162, 3.16227766])
~~~~

~~~python
np.diag(S, 1)[:, 1:]
~~~

~~~
# np.diag(S, 1)[:, 1:] (í–‰, ë ¬ ìˆ˜ë¥¼ ë§ì¶°ì£¼ê¸° ìœ„í•´ì„œ)
array([[3.46410162, 0.        ],
       [0.        , 3.16227766],
       [0.        , 0.        ]])
~~~

~~~python
VT
~~~

~~~
# VT  (ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„°, ê²°ê³¼ëŠ” ì „ì¹˜í–‰ë ¬ë¡œ ì¶œë ¥ëœë‹¤.)
array([[-0.70710678, -0.70710678],
       [ 0.70710678, -0.70710678]])
~~~

~~~python
U @ np.diag(S, 1)[:, 1:] @ VT
~~~

~~~
# U @ np.diag(S, 1)[:, 1:] @ VT ì˜ ê²°ê³¼ (íŠ¹ì´ë¶„í•´ ê²°ê³¼, ì›ë˜ì˜ í–‰ë ¬ì´ ì¶œë ¥ëœë‹¤.)
array([[ 3., -1.],
       [ 1.,  3.],
       [ 1.,  1.]])
~~~

- ì¶•ì†Œí˜•ì„ êµ¬í•˜ë ¤ë©´ ì¸ìˆ˜ `full_matrices=False`ë¡œ ì§€ì •í•œë‹¤.

~~~python
U2, S2, VT2 = svd(A, full_matrices=False)
~~~

~~~python
U2
~~~

~~~
# U2 (ì™¼ìª½íŠ¹ì´ë²¡í„°)
array([[-4.08248290e-01,  8.94427191e-01],
       [-8.16496581e-01, -4.47213595e-01],
       [-4.08248290e-01, -2.06937879e-16]])
~~~

~~~python
S2
~~~

~~~
#S2 (íŠ¹ì‡ê°’)
array([3.46410162, 3.16227766])
~~~

~~~python
VT2
~~~

~~~
#VT2 (ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„°)
array([[-0.70710678, -0.70710678],
       [ 0.70710678, -0.70710678]])
~~~

~~~~python
U2 @ np.diag(S2) @ VT2
~~~~

~~~
array([[ 3., -1.],
       [ 1.,  3.],
       [ 1.,  1.]])
~~~



### íŠ¹ì‡ê°’ê³¼ íŠ¹ì´ë²¡í„°ì˜ ê´€ê³„

**í–‰ë ¬ ğ‘‰ëŠ” ì •ê·œì§êµ(orthonormal)í–‰ë ¬**ì´ë¯€ë¡œ **ì „ì¹˜í–‰ë ¬ì´ ì—­í–‰ë ¬**ì´ë‹¤.
$$
V^T = V^{-1}
$$

**ì •ë°© í–‰ë ¬ Aì— ëŒ€í•œ ì—­í–‰ë ¬ì€ ì›ë˜ì˜ í–‰ë ¬ Aì™€ ë‹¤ìŒ ê´€ê³„ë¥¼ ë§Œì¡±í•˜ëŠ” ì •ë°© í–‰ë ¬ì„ ë§í•œë‹¤. IëŠ” í•­ë“± í–‰ë ¬(identity matrix) ì´ë‹¤.**
$$
A^{-1} A = A A^{-1} = I
$$

$$
V^T V = V V^T = I
$$

$$
V^{-1} = V^T
$$

íŠ¹ì´ë¶„í•´ëœ ë“±ì‹ì˜ ì–‘ë³€ì— ğ‘‰ë¥¼ ê³±í•˜ë©´,

$$
AV = U\Sigma V^TV = U\Sigma
$$

$$
A 
\begin{bmatrix}
v_1 & v_2 & \cdots & v_M
\end{bmatrix}
= 
\begin{bmatrix}
u_1 & u_2 & \cdots & u_N
\end{bmatrix}
\begin{bmatrix}
\sigma_1 & 0 & \cdots \\
0 & \sigma_2 & \cdots \\
\vdots & \vdots & \ddots \\
\end{bmatrix}
$$

í–‰ë ¬ ğ´ë¥¼ ê³±í•˜ì—¬ ì •ë¦¬í•˜ë©´ ğ‘€ > N ë•ŒëŠ”

$$
\begin{bmatrix}
Av_1 & Av_2 & \cdots & Av_N
\end{bmatrix}
= 
\begin{bmatrix}
\sigma_1u_1 & \sigma_2u_2 & \cdots & \sigma_Nu_N
\end{bmatrix}
$$

N > M ì¼ ë•ŒëŠ”

$$
\begin{bmatrix}
Av_1 & Av_2 & \cdots & Av_M
\end{bmatrix}
= 
\begin{bmatrix}
\sigma_1u_1 & \sigma_2u_2 & \cdots & \sigma_Mu_M
\end{bmatrix}
$$

ì¦‰, **ğ‘–ë²ˆì§¸ íŠ¹ì‡ê°’ ğœğ‘–ì™€ íŠ¹ì´ë²¡í„° ğ‘¢ğ‘–, ğ‘£ğ‘–ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê´€ê³„ê°€ ìˆë‹¤.**

$$
Av_i = \sigma_i u_i \;\; (i=1, \ldots, \text{min}(M,N))
$$

â€‹ì´ ê´€ê³„ëŠ” ê³ ìœ ë¶„í•´ì™€ ë¹„ìŠ·í•˜ì§€ë§Œ ê³ ìœ ë¶„í•´ì™€ëŠ” ë‹¬ë¦¬ **ì¢Œë³€ê³¼ ìš°ë³€ì˜ ë²¡í„°ê°€ ë‹¤ë¥´ë‹¤**.

ìœ„ì—ì„œ ì˜ˆë¡œ ë“¤ì—ˆë˜ í–‰ë ¬ì˜ ê²½ìš° ì•„ë˜ì™€ ê°™ì´ ì„±ë¦½í•œë‹¤. (ì¢Œë³€(v)ê³¼ ìš°ë³€(u)ì˜ ë²¡í„°ê°€ ë‹¤ë¥´ë‹¤.)
  $$
  Av_1 = \sigma_1u_1
  $$

  $$
  \begin{bmatrix}
  3 & -1 \\
  1 & 3 \\
  1 & 1
  \end{bmatrix}
  \begin{bmatrix}
  -\frac{1}{\sqrt{2}} \\
  -\frac{1}{\sqrt{2}} 
  \end{bmatrix}
  =
  \sqrt{12}
  \begin{bmatrix}
  -\frac{1}{\sqrt{6}} \\ -\frac{2}{\sqrt{6}} \\ -\frac{1}{\sqrt{6}}
  \end{bmatrix}
  $$

  $$
  Av_2 = \sigma_2u_2
  $$

$$
\begin{bmatrix}
3 & -1 \\
1 & 3 \\
1 & 1
\end{bmatrix}
\begin{bmatrix}
 \frac{1}{\sqrt{2}} \\
-\frac{1}{\sqrt{2}} 
\end{bmatrix}
=
\sqrt{10}
\begin{bmatrix}
 \frac{2}{\sqrt{5}} \\  
-\frac{1}{\sqrt{5}} \\ 
 0 \\ 
\end{bmatrix}
$$


### íŠ¹ì´ë¶„í•´ì™€ ê³ ìœ ë¶„í•´ì˜ ê´€ê³„

í–‰ë ¬ ğ´ì˜ ê³µë¶„ì‚°í–‰ë ¬ $$ğ´^ğ‘‡ğ´$$ëŠ”

$$
\begin{eqnarray}
A^TA^{} 
&=& (V^{} \Sigma^T U^T)( U^{}\Sigma^{} V^T) \\
&=& V^{} \Lambda^{} V^T \\
\end{eqnarray}
$$

â€‹ê°€ ë˜ì–´ í–‰ë ¬ ğ´ì˜ íŠ¹ì‡ê°’ì˜ ì œê³±(ê³¼ 0)ì´ ê³µë¶„ì‚°í–‰ë ¬ $$ğ´^ğ‘‡ğ´$$ì˜ ê³ ìœ ê°’, **í–‰ë ¬ ğ´ì˜ ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„°ê°€ ê³µë¶„ì‚°í–‰ë ¬ $$ğ´^ğ‘‡ğ´$$ì˜ ê³ ìœ ë²¡í„°**ê°€ ëœë‹¤.

ìœ„ ì‹ì—ì„œ Î›ì€ ğ‘ì´ ğ‘€ë³´ë‹¤ í¬ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

$$
\Lambda
= 
\begin{bmatrix}
\sigma_1^2 & 0 & \cdots & 0 \\
0 & \sigma_2^2 & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & \sigma_M^2  \\
\end{bmatrix}
$$

ìœ„ ì‹ì—ì„œ Î›ì€ ğ‘ì´ ğ‘€ë³´ë‹¤ ì‘ìœ¼ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

$$
\Lambda
= 
\begin{bmatrix}
\sigma_1^2 & 0 & \cdots & 0 & \cdots & 0 \\
0 & \sigma_2^2 & \cdots & 0 & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots & \vdots \\
0 & 0 & \cdots & \sigma_N^2 & \cdots & 0 \\
\vdots & \vdots & \cdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & 0 & \cdots & 0 \\
\end{bmatrix}
= \text{diag}(\sigma_1^2, \sigma_2^2, \cdots, \sigma_N^2, 0, \cdots, 0)
$$

ë§ˆì°¬ê°€ì§€ ë°©ë²•ìœ¼ë¡œ **í–‰ë ¬ ğ´ì˜ ì™¼ìª½ íŠ¹ì´ë²¡í„°ê°€ ê³µë¶„ì‚°í–‰ë ¬ $$ğ´ğ´^ğ‘‡$$ì˜ ê³ ìœ ë²¡í„°**ê°€ ëœë‹¤ëŠ” ê²ƒì„ ì¦ëª…í•  ìˆ˜ ìˆë‹¤.

Numpy ë¡œ ì¦ëª…

  ~~~python
  w, V = np.linalg.eig(A.T @ A)
  ~~~

  ~~~python
  w  # A.T Aì˜ ê³ ìœ³ê°’
  # ê²°ê³¼ array([12., 10.])
  ~~~

  ~~~python
  S ** 2  # Aì˜ íŠ¹ì‡ê°’ì˜ ì œê³±
  # ê²°ê³¼ array([12., 10.])
  ~~~

  ~~~python
  V  # A.T Aì˜ ê³ ìœ ë²¡í„°
  # ê²°ê³¼ 
  # array([[ 0.70710678, -0.70710678],
  #        [ 0.70710678,  0.70710678]])
  ~~~

  ~~~python
  VT.T  # Aì˜ ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„°
  # ê²°ê³¼
  # array([[-0.70710678,  0.70710678],
  #        [-0.70710678, -0.70710678]])
  ~~~


### 1ì°¨ì› ê·¼ì‚¬

2ì°¨ì› í‰ë©´ìœ„ì— 3ê°œì˜ 2ì°¨ì› ë²¡í„° $$ğ‘_1,ğ‘_2,ğ‘_3$$ê°€ ìˆë‹¤. ì›ì ì„ ì§€ë‚˜ë©´ì„œ ëª¨ë“  ì ë“¤ê³¼ ê°€ëŠ¥í•œí•œ ê°€ê¹Œì´ ìˆëŠ” ì§ì„ ì„ ë§Œë“¤ê³  ì‹¶ë‹¤ë©´ ì§ì„ ì˜ ë°©í–¥ì„ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ? ì§ì„ ì˜ ë°©í–¥ì„ ë‚˜íƒ€ë‚´ëŠ” ë‹¨ìœ„ ë²¡í„°ë¥¼ ğ‘¤ë¼ê³  í•˜ì.

![image-20190417204135682](../../../resource/img/image-20190417204135682.png)

ë²¡í„° ğ‘¤ì™€ ì  ğ‘ğ‘–ì˜ ê±°ë¦¬ì˜ ì œê³±ì€ ë‹¤ìŒì²˜ëŸ¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.

$$
\Vert a_i^{\perp w}\Vert^2 = \Vert a_i\Vert^2 - \Vert a_i^{\Vert w}\Vert^2 = \Vert a_i\Vert^2 - (a_i^Tw)^2
$$

ë²¡í„° $$a_1, a_2, a_3$$ë¥¼ í–‰ë²¡í„°ë¡œ ê°€ì§€ëŠ” í–‰ë ¬ Aë¥¼ ê°€ì •í•˜ë©´ 

$$
\begin{align}
A = \begin{bmatrix} a_1^T \\ a_2^T \\ a_3^T \end{bmatrix}
\end{align}
$$

í–‰ë²¡í„°ì˜ ë†ˆì˜ ì œê³±ì˜ í•©ì€ í–‰ë ¬ì˜ ë†ˆì´ë¯€ë¡œ ëª¨ë“  ì ë“¤ê³¼ì˜ ê±°ë¦¬ì˜ ì œê³±ì˜ í•©ì€ í–‰ë ¬ì˜ ë†ˆìœ¼ë¡œ ê³„ì‚°ëœë‹¤.

$$
\begin{align}
\begin{aligned}
\sum_{i=1}^3 \Vert a_i^{\perp w}\Vert^2 
&= \sum_{i=1}^3 \Vert a_i\Vert^2 - \sum_{i=1}^3  (a_i^Tw)^2 \\
&= \Vert A \Vert^2 - \Vert Aw\Vert^2 \\
\end{aligned}
\end{align}
$$

ì  $$a_i$$ì˜ ìœ„ì¹˜ê°€ ê³ ì •ë˜ì–´ ìˆìœ¼ë¯€ë¡œ í–‰ë ¬ Aì˜ ë†ˆ ê°’ì€ ê³ ì •ë˜ì–´ ìˆë‹¤. ê·¸ë˜ì„œ ì´ ê°’ì´ ê°€ì¥ ì‘ì•„ì§€ë ¤ë©´ $$\Vert A \Vert$$ê°’ì´ ê°€ì¥ í¬ê²Œ ë§Œë“œëŠ” wë¥¼ ì°¾ìœ¼ë©´ ëœë‹¤. ìˆ˜ì‹ìœ¼ë¡œ í‘œí˜„í•˜ìë©´ $$\arg\max_w \Vert Aw \Vert^2$$ ì´ë‹¤.
_______________

(ì°¸ê³  ë‚´ìš©1)
ë§Œì•½ vê°€ ì›ì ì„ ì§€ë‚˜ëŠ” ì§ì„ ì˜ ë°©í–¥ì„ ë‚˜íƒ€ë‚´ëŠ” ë‹¨ìœ„ ë²¡í„°ë¼ê³  í•˜ì. ì´ ë•Œ ê·¸ ì§ì„ ìœ„ì— ìˆì§€ ì•ŠëŠ” ì–´ë–¤ ì  xì™€ ê·¸ ì§ì„ ê³¼ì˜ ê±°ë¦¬ì˜ ì œê³±ì´ ë‹¤ìŒê³¼ ê°™ë‹¤.

ì§ì„ ìœ„ì— ìˆì§€ ì•ŠëŠ” ì–´ë–¤ ì  xì™€ ê·¸ ì§ì„ ê³¼ì˜ ê±°ë¦¬ëŠ” í”¼íƒ€ê³ ë¼ìŠ¤ì˜ ì •ì˜ì— ì˜í•´ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\Vert x^{\perp v}\Vert^2 = \Vert x\Vert^2 - \Vert x^{\Vert v}\Vert^2
$$

ì´ ë•Œ ì§êµì„±ë¶„ì˜ ê¸¸ì´ë¥¼ êµ¬í•˜ë©´ vê°€ ë‹¨ìœ„ë²¡í„°ë¼ëŠ” ì ì„ ì´ìš©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\| x^{\Vert v} \| 
= \dfrac{x^Tv}{\|v\|} 
= x^Tv
$$

ë”°ë¼ì„œ ì§ì„ ìœ„ì— ìˆì§€ ì•ŠëŠ” ì–´ë–¤ ì  xì™€ ê·¸ ì§ì„ ê³¼ì˜ ê±°ë¦¬ì˜ ì œê³±ì´ ë‹¤ìŒê³¼ ê°™ë‹¤. 

$$
\Vert x^{\perp v}\Vert^2 = \| x \|^2 - (x^Tv)^2
$$

(ì°¸ê³ ë‚´ìš©2)
í–‰ë ¬ ğ´($$ A\in \mathbf{R}^{N \times M}$$)ì˜ ë†ˆì˜ ì œê³±$$ â€–ğ´â€–^2$$ì´ ê·¸ í–‰ë ¬ì„ ì´ë£¨ëŠ” í–‰ ë²¡í„° $$ğ‘Ÿ_ğ‘–$$ì˜ ë†ˆì˜ ì œê³±ì˜ í•© ë˜ëŠ” ì—´ ë²¡í„° $$ğ‘_ğ‘–$$ì˜ ë†ˆì˜ ì œê³±ì˜ í•©ê³¼ ê°™ë‹¤.

í’€ì´;
$$
\Vert A \Vert^2 = \sum_{i=1}^N \Vert r_i \Vert^2  = \sum_{j=1}^M \Vert c_j \Vert^2
$$

$$
\Vert A \Vert^2 ={\sum_{i=1}^N \sum_{j=1}^M a_{ij}^2}={\sum_{i=1}^M \sum_{j=1}^N a_{ij}^2}
$$

$$
\Vert r_i \Vert^2 = \sum_{j=1}^M \Vert a_{i,j}\Vert^2
$$

$$
\Vert A \Vert^2 =\sum_{i=1}^N \left( \sum_{j=1}^M a_{ij}^2 \right) = \sum_{i=1}^N \Vert r_i \Vert^2
$$

$$
\Vert c_j \Vert^2 = \sum_{i=1}^N \Vert a_{i,j}\Vert^2
$$

$$
\Vert A \Vert^2 =\sum_{j=1}^M \left( \sum_{i=1}^N a_{ij}^2 \right) = \sum_{j=1}^M \Vert c_i \Vert^2
$$


________________________

### 1ì°¨ì› ê·¼ì‚¬ì˜ í’€ì´

ìœ„ì—ì„œ ì˜ˆë¡œ ë“  í–‰ë ¬ $$A \in \mathbf{R}^{3 \times 2}$$ë¥¼ íŠ¹ì´ë¶„í•´í•˜ë©´ 2ê°œì˜ íŠ¹ì‡ê°’, ì™¼ìª½/ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„°ë¥¼ ê°€ì§„ë‹¤. ì´ë¥¼ ê°ê° ë‹¤ìŒì²˜ëŸ¼ ì´ë¦„ë¶™ì¸ë‹¤.

ì²«ë²ˆì§¸ íŠ¹ì‡ê°’: $$\sigma_1$$, ì²«ë²ˆì§¸ ì™¼ìª½ íŠ¹ì´ë²¡í„° $$u_1 \in \mathbf{R}^{3}$$, ì²«ë²ˆì§¸ ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„° $$v_1 \in \mathbf{R}^{2}$$
ë‘ë²ˆì§¸ íŠ¹ì‡ê°’: $$\sigma_2$$, ë‘ë²ˆì§¸ ì™¼ìª½ íŠ¹ì´ë²¡í„° $$u_2 \in \mathbf{R}^{3}$$, ë‘ë²ˆì§¸ ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„° $$v_2 \in \mathbf{R}^{2}$$

1) ì²«ë²ˆì§¸ íŠ¹ì‡ê°’ $$\sigma_1$$ì€ ë‘ë²ˆì§¸ íŠ¹ì‡ê°’ $$\sigma_2$$ë³´ë‹¤ ê°™ê±°ë‚˜ í¬ë‹¤.
$$
\sigma_1 \geq \sigma_2
$$
2) Aì— ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„°ë¥¼ ê³±í•˜ë©´ ì™¼ìª½ íŠ¹ì´ë²¡í„° ë°©í–¥ì´ ëœë‹¤.
$$
A v_1 = \sigma_1 u_1
$$

$$
A v_2 = \sigma_2 u_2
$$

3) ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„° $$ğ‘£_1,ğ‘£_2$$ëŠ” ì„œë¡œ ì§êµí•˜ë¯€ë¡œ (ê°™ì€ ë°©í–¥ì´ ì•„ë‹ˆë¼ì„œ) ì„ í˜•ë…ë¦½ì´ê³  2ì°¨ì› í‰ë©´ê³µê°„ì˜ ê¸°ì €ë²¡í„°ê°€ ë  ìˆ˜ ìˆë‹¤.

4) ìš°ë¦¬ëŠ” â€–ğ´ğ‘¤â€–ì˜ ê°’ì´ ê°€ì¥ í¬ê²Œ ë§Œë“œëŠ” ğ‘¤ë¥¼ ì°¾ì•„ì•¼ í•˜ëŠ”ë° ğ‘¤ëŠ” 2ì°¨ì› ë²¡í„°ì´ë¯€ë¡œ 2ì°¨ì› í‰ë©´ê³µê°„ì˜ ê¸°ì €ë²¡í„°ì¸ $$v_1, v_2$$ì˜ ì„ í˜•ì¡°í•©ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.
$$
w = w_{1} v_1 + w_{2} v_2
$$
  ë‹¨, ğ‘¤ë„ ë‹¨ìœ„ë²¡í„°ì´ë¯€ë¡œ $$w_1,w_2$$ëŠ” ë‹¤ìŒ ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼ í•œë‹¤.
$$
w_{1}^2 + w_{2}^2 = 1
$$
5) ì´ ë•Œ â€–ğ´ğ‘¤â€–ì˜ ê°’ì€
$$
\begin{eqnarray}
\Vert Aw\Vert^2 
&=& \Vert A(w_{1} v_1 + w_{2} v_2)\Vert^2 \\
&=& \Vert w_{1}Av_1 + w_{2}Av_2 \Vert^2 \\
&=& \Vert w_{1} \sigma_1 u_1 + w_{2} \sigma_2 u_2 \Vert^2 \\
&=& \Vert w_{1} \sigma_1 u_1 \Vert^2 + \Vert w_{2} \sigma_2 u_2 \Vert^2 \;\; \text{(ë²¡í„°ì˜ ì§êµ)} \\
&=& w_{1}^2 \sigma_1^2 \Vert  u_1 \Vert^2 + w_{2}^2 \sigma_2^2 \Vert  u_2 \Vert^2 \\
&=& w_{1}^2 \sigma_1^2 + w_{2}^2 \sigma_2^2  \;\; \text{(ë‹¨ìœ„ë²¡í„°)}\\
\end{eqnarray}
$$
6) ğœ1>ğœ2>0ì´ë¯€ë¡œ $$w_{1}^2 + w_{2}^2 = 1$$ë¼ëŠ” ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ì„œ ìœ„ ê°’ì„ ê°€ì¥ í¬ê²Œí•˜ëŠ” $$w_1, w_2$$ê°’ì€
$$
w_{1} = 1, w_{2} = 0
$$
7) ì¦‰, ì²«ë²ˆì§¸ **ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„° ë°©í–¥**ìœ¼ë¡œ í•˜ëŠ” ê²ƒì´ë‹¤.
$$
w = v_1
$$
8) ì´ ë•Œ â€–ğ´ğ‘¤â€–ëŠ” ì²«ë²ˆì§¸ íŠ¹ì‡ê°’ì´ ëœë‹¤.
$$
\Vert Aw\Vert = \Vert Av_1\Vert = \Vert \sigma_1 u_1\Vert = \sigma_1 \Vert u_1\Vert = \sigma_1
$$

ìœ„ì—ì„œ ì˜ˆë¡œ ë“¤ì—ˆë˜ í–‰ë ¬ Aì˜ ê²½ìš°ì—ëŠ”
  $$
  A = 
  \begin{bmatrix}
  3 & -1 \\
  1 & 3 \\
  1 & 1
  \end{bmatrix}
  $$

ì²«ë²ˆì§¸ ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„°ê°€ ê°€ì¥ ê±°ë¦¬ì˜ í•©ì´ ì‘ì€ ë°©í–¥ì´ ëœë‹¤. 
  $$
  v_1 = 
  \begin{bmatrix}
  \frac{\sqrt{2}}{2} \\
  \frac{\sqrt{2}}{2} \\
  \end{bmatrix}
  $$

ì´ ë•Œì˜ ê±°ë¦¬ì˜ ì œê³±ì˜ í•©ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
  $$
  \Vert A \Vert^2 - \Vert Aw\Vert^2
  =\Vert A \Vert^2 - \sigma_1^2
  $$


### ì¼ë°˜ì ì¸ í’€ì´

$$
\begin{eqnarray}
\Vert Aw \Vert^2 
&=& \sum_{i=1}^{N}  (a_i^Tw)^2 \\
&=& \sum_{i=1}^{N}  (a_i^Tw)^T(a_i^Tw) \\
&=& \sum_{i=1}^{N}  w^Ta_ia_i^Tw \\
&=& w^T \left( \sum_{i=1}^{N}  a_ia_i^T \right) w \\
&=& w^T A^TA w \\
\end{eqnarray}
$$

ê³µë¶„ì‚°í–‰ë ¬ì˜ ê³ ìœ ë¶„í•´ ê³µì‹ì„ ì´ìš©í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.
  $$
  \begin{eqnarray}
  w^T A^TA w 
  &=& w^T V \Lambda V^T w \\
  &=& w^T \left( \sum_{i=1}^{M}  \sigma^2_iv_iv_i^T \right) w \\
  &=& \sum_{i=1}^{M}\sigma^2_i(w^Tv_i)(v_i^Tw) \\
  &=& \sum_{i=1}^{M}\sigma^2_i\Vert v_i^Tw\Vert^2 \\
  \end{eqnarray}
  $$

ì´ ì‹ì—ì„œ Mì€ 0ì´ ì•„ë‹Œ íŠ¹ì‡ê°’ì˜ ê°¯ìˆ˜ì´ë‹¤. ì¦‰ ìš°ë¦¬ê°€ í’€ì–´ì•¼ í•  ë¬¸ì œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

  $$
  \arg\max_w \Vert Aw \Vert^2 = \arg\max_w \sum_{i=1}^{M}\sigma^2_i\Vert v_i^Tw\Vert^2
  $$
  
  ìœ„ ê°’ì„ ê°€ì¥ í¬ê²Œ í•˜ë ¤ë©´ wë¥¼ ê°€ì¥ í° íŠ¹ì‡ê°’ì— ëŒ€ì‘í•˜ëŠ” ì˜¤ë¥¸ìª½ ê³ ìœ ë²¡í„° $$v_1$$ìœ¼ë¡œ í•´ì•¼í•œë‹¤.


### ë­í¬-1 ê·¼ì‚¬ë¬¸ì œ

$$ğ‘_ğ‘–$$ë¥¼ $$w$$ì— íˆ¬ì˜í•œ ë²¡í„°ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

$$
a^{\Vert w}_i = (a_i^Tw)w
$$

$$w$$ ë²¡í„°ë¥¼ ì´ìš©í•˜ë©´ $$N$$ê°œì˜ $$M$$ì°¨ì› ë²¡í„° $$a_1, a_2, \cdots, a_N\;(a_i \in \mathbf{R}^M)$$ë¥¼ 1ì°¨ì›ìœ¼ë¡œ íˆ¬ì˜(projection)í•˜ì—¬ ê°€ì¥ ë¹„ìŠ·í•œ ğ‘ê°œì˜ 1ì°¨ì› ë²¡í„° ë¥¼$$a^{\Vert w}_1, a^{\Vert w}_2, \cdots, a^{\Vert w}_N\;(a^{\Vert w}_i \in \mathbf{R}^1)$$ ë§Œë“¤ ìˆ˜ ìˆë‹¤

$$
A'=
\begin{bmatrix}
\left(a^{\Vert w}_1\right)^T \\
\left(a^{\Vert w}_2\right)^T \\
\vdots \\
\left(a^{\Vert w}_N\right)^T
\end{bmatrix}
=
\begin{bmatrix}
a_1^Tw^{}w^T \\
a_2^Tw^{}w^T \\
\vdots \\
a_N^Tw^{}w^T
\end{bmatrix}
=
\begin{bmatrix}
a_1^T \\
a_2^T \\
\vdots \\
a_N^T
\end{bmatrix}
w^{}w^T
=
Aw^{}w^T
$$

ì´ ë‹µì€ ì›ë˜ í–‰ë ¬ ğ´ì— ë­í¬-1 í–‰ë ¬ $$ww^T$$ë¥¼ ê³±í•´ì„œ ì›ë˜ì˜ í–‰ë ¬ ğ´ì™€ ê°€ì¥ ë¹„ìŠ·í•œ í–‰ë ¬ ğ´â€²ì„ ë§Œë“œëŠ” ë¬¸ì œì™€ ê°™ë‹¤.

$$
\arg\min_w \Vert A - A' \Vert = \arg\min_w \Vert A^{} - A^{}w^{}w^T \Vert
$$

ìœ„ì˜ ë¬¸ì œë¥¼ **ë­í¬-1 ê·¼ì‚¬ë¬¸ì œ(rank-1 approximation problem)**ë¼ê³ ë„ í•œë‹¤.



### K ì°¨ì› ê·¼ì‚¬

ì´ë²ˆì—ëŠ” ğ‘ê°œì˜ ğ‘€ì°¨ì› ë²¡í„° $$a_1, a_2, \cdots, a_N\;(a_i \in \mathbf{R}^M)$$ë¥¼ 1ì°¨ì›ì´ ì•„ë‹ˆë¼ ì •ê·œì§êµì¸ ê¸°ì €ë²¡í„° $$w_1, w_2, \cdots, w_K$$ë¡œ ì´ë£¨ì–´ì§„ ğ¾ì°¨ì› ë²¡í„°ê³µê°„ìœ¼ë¡œ íˆ¬ì˜í•˜ì—¬ ê°€ì¥ ë¹„ìŠ·í•œ ğ‘ê°œì˜ ğ¾ì°¨ì› ë²¡í„° $$a^{\Vert w}_1, a^{\Vert w}_2, \cdots, a^{\Vert w}_N\;$$ë¥¼ ë§Œë“¤ê¸° ìœ„í•œ ì •ê·œì§êµ ê¸°ì €ë²¡í„° $$w_1, w_2, \cdots, w_K$$ë¥¼ ì°¾ëŠ” ë¬¸ì œë¥¼ ìƒê°í•˜ì. ì´ ë¬¸ì œëŠ” **ë­í¬-ğ¾ê·¼ì‚¬ë¬¸ì œ**ë¼ê³  í•œë‹¤.

ê¸°ì €ë²¡í„°í–‰ë ¬ì„ ğ‘Šë¼ê³  í•˜ì.
  $$
  W = \begin{bmatrix} w_1 & w_2 & \cdots & w_K \end{bmatrix}
  $$

ì •ê·œì§êµ ê¸°ì €ë²¡í„°ì— ëŒ€í•œ ë²¡í„° $$ğ‘_ğ‘–$$ì˜ íˆ¬ì˜ $$a^{\Vert w}_i$$ëŠ” ê° ê¸°ì €ë²¡í„°ì— ëŒ€í•œ ë‚´ì ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

$$
\begin{eqnarray}
a^{\Vert w}_i 
&=& 
(a_i^Tw_1)w_1 +
(a_i^Tw_2)w_2 +
\cdots
+ (a_i^Tw_K)w_K \\
\end{eqnarray}
=
\sum_{k=1}^K (a_i^Tw_k)w_k
$$

ë²¡í„° ğ‘1,ğ‘2,â‹¯,ğ‘ğ‘ë¥¼ í–‰ë²¡í„°ë¡œ ê°€ì§€ëŠ” í–‰ë ¬ ğ´ë¥¼ ê°€ì •í•˜ë©´
  $$
  A = \begin{bmatrix} a_1^T \\ a_2^T \\ \vdots \\ a_N^T \end{bmatrix}
  $$

ëª¨ë“  ì ë“¤ê³¼ì˜ ê±°ë¦¬ì˜ ì œê³±ì˜ í•©ì€ ë‹¤ìŒì²˜ëŸ¼ í–‰ë ¬ì˜ ë†ˆìœ¼ë¡œ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.

$$
\begin{eqnarray}
\sum_{i=1}^N \Vert a_i^{\perp w}\Vert^2 
&=& \sum_{i=1}^N \Vert a_i\Vert^2 - \sum_{i=1}^N \Vert a^{\Vert w}_i\Vert^2 \\
&=& \Vert A \Vert^2 - \sum_{i=1}^N \Vert a^{\Vert w}_i\Vert^2 \\
\end{eqnarray}
$$

í–‰ë ¬ ğ´ëŠ” ì´ë¯¸ ì£¼ì–´ì ¸ìˆìœ¼ë¯€ë¡œ ì´ ê°’ì„ ê°€ì¥ ì‘ê²Œ í•˜ë ¤ë©´ ë‘ë²ˆì§¸ í•­ì˜ ê°’ì„ ê°€ì¥ í¬ê²Œ í•˜ë©´ ëœë‹¤. ë‘ë²ˆì§¸ í•­ì€ K=1ì¼ ë•Œì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ê³µë¶„ì‚°í–‰ë ¬ í˜•íƒœë¡œ ë°”ê¿€ ìˆ˜ ìˆë‹¤.

$$
\begin{eqnarray}
\sum_{i=1}^N \Vert a^{\Vert w}_i\Vert^2 
&=& \sum_{i=1}^N \sum_{k=1}^K \Vert (a_i^Tw_k)w_k \Vert^2 \\
&=& \sum_{i=1}^N \sum_{k=1}^K \Vert a_i^Tw_k \Vert^2 \\
&=& \sum_{k=1}^K w_k^T A^TA w_k \\
\end{eqnarray}
$$

ê³µë¶„ì‚°í–‰ë ¬ì˜ ê³ ìœ ë¶„í•´ë¥¼ ì‚¬ìš©í•˜ë©´

$$
\begin{eqnarray}
\sum_{k=1}^K w_k^T A^TA w_k 
&=& \sum_{k=1}^K w_k^T V \Lambda V^T w_k \\
&=& \sum_{k=1}^K w_k^T \left( \sum_{i=1}^{M}  \sigma^2_iv_iv_i^T \right) w_k \\
&=& \sum_{k=1}^K \sum_{i=1}^{M}\sigma^2_i\Vert v_i^Tw_k\Vert^2 \\
\end{eqnarray}
$$

**ê°€ì¥ í° ğ¾ê°œì˜ íŠ¹ì‡ê°’ì— ëŒ€ì‘í•˜ëŠ” ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„°ê°€ ê¸°ì €ë²¡í„°ì¼ ë•Œ ê°€ì¥ ê°’ì´ ì»¤ì§„ë‹¤.**



### ë­í¬-K ê·¼ì‚¬ë¬¸ì œ

ìš°ë¦¬ê°€ ì°¾ì•„ì•¼ í•˜ëŠ” ê²ƒì€ ì´ ê°’ì„ ê°€ì¥ í¬ê²Œ í•˜ëŠ” ğ¾ê°œì˜ ì˜ë²¡í„°ê°€ ì•„ë‹Œ ì§êµí•˜ëŠ” ë‹¨ìœ„ë²¡í„° ğ‘¤ğ‘˜ì´ë‹¤. ê³ ìœ ë¶„í•´ì˜ ì„±ì§ˆë¡œë¶€í„° **ì˜¤ë¥¸ìª½ ê¸°ì €ë²¡í„° ì¤‘ ê°€ì¥ í° ğ¾ê°œì˜ íŠ¹ì‡ê°’ì— ëŒ€ì‘í•˜ëŠ” ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„°ê°€ ìš°ë¦¬ê°€ ì°¾ëŠ” ê¸°ì €ë²¡í„°ê°€ ëœë‹¤.**

ë­í¬-ğ¾ ê·¼ì‚¬ë¬¸ì œì˜ í˜•íƒœë¡œ ë§Œë“¤ ìˆ˜ë„ ìˆë‹¤.
  $$
  \begin{eqnarray}
  a^{\Vert w}_i 
  &=& 
  (a_i^Tw_1)w_1 +
  (a_i^Tw_2)w_2 +
  \cdots
  + (a_i^Tw_K)w_K \\
  &=&
  \begin{bmatrix} w_1 & w_2 & \cdots & w_K \end{bmatrix}
  \begin{bmatrix} a_i^Tw_1 \\ a_i^Tw_2 \\ \vdots \\ a_i^Tw_K \end{bmatrix} \\
  &=&
  \begin{bmatrix} w_1 & w_2 & \cdots & w_K \end{bmatrix}
  \begin{bmatrix} w_1^T \\ w_2^T \\ \vdots \\ w_K^T \end{bmatrix} a_i \\
  &=&
  WW^Ta_i
  \end{eqnarray}
  $$

ì´ëŸ¬í•œ íˆ¬ì˜ë²¡í„°ë¥¼ ëª¨ì•„ë†“ì€ í–‰ë ¬ ğ´â€²ëŠ”

$$
A'=
\begin{bmatrix}
\left(a^{\Vert w}_1\right)^T \\
\left(a^{\Vert w}_2\right)^T \\
\vdots \\
\left(a^{\Vert w}_N\right)^T
\end{bmatrix}
=
\begin{bmatrix}
a_1^TW^{}W^T \\
a_2^TW^{}W^T\\
\vdots \\
a_N^TW^{}W^T
\end{bmatrix}
=
\begin{bmatrix}
a_1^T \\
a_2^T \\
\vdots \\
a_N^T
\end{bmatrix}
W^{}W^T
=
AW^{}W^T
$$

ì´ ë¬¸ì œëŠ” ì›ë˜ í–‰ë ¬ ğ´ì— ë­í¬-K í–‰ë ¬ $$WW^T$$ë¥¼ ê³±í•´ì„œ ì›ë˜ì˜ í–‰ë ¬ ğ´ì™€ ê°€ì¥ ë¹„ìŠ·í•œ í–‰ë ¬ ğ´â€²ì„ ë§Œë“œëŠ” ë¬¸ì œì™€ ê°™ë‹¤

$$
\arg\min_{w_1,\cdots,w_K} \Vert A - AW^{}W^T \Vert
$$

