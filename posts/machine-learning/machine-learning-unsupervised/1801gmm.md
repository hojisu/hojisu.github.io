<script> MathJax.Hub.Queue(["Typeset", MathJax.Hub]); </script>

# ê°€ìš°ì‹œì•ˆ í˜¼í•©ëª¨í˜•ê³¼ EM ë°©ë²•

### Summary

- ê°€ìš°ì‹œì•ˆ í˜¼í•©ëª¨í˜•ì€ ì‹¤ìˆ˜ê°’ì„ ì¶œë ¥í•˜ëŠ” í™•ë¥ ë³€ìˆ˜ê°€ í´ëž˜ìŠ¤ ì¹´í…Œê³ ë¦¬ í™•ë¥ ë³€ìˆ˜ì˜ ê°’ì— ë”°ë¼ ë‹¤ë¥¸ ê¸°ëŒ“ê°’ê³¼ ë¶„ì‚°ì„ ê°€ì§€ëŠ” ë³µìˆ˜ì˜ ê°€ìš°ì‹œì•ˆ ì •ê·œë¶„í¬ë“¤ë¡œ ì´ë£¨ì–´ì§„ ëª¨í˜•ì´ë‹¤
- ê°€ìš°ì‹œì•ˆ í˜¼í•©ëª¨í˜•ì˜ ëª¨ìˆ˜ì¶”ì • ë°©ë²•ìœ¼ë¡œëŠ” EMë°©ë²•ì´ ìžˆë‹¤.
- EM ë°©ë²•ì€ ëª¨ìˆ˜($$\theta : \pi_k, \mu_k, \Sigma_k$$)ì™€ responsibility(hidden state, $$\pi_k$$)ë¥¼ ë²ˆê°ˆì•„ ì¶”ì •í•˜ë©° ì •í™•ë„ë¥¼ ë†’ì—¬ê°€ëŠ” ë°©ë²•ì´ë‹¤. ìž ìž¬ë³€ìˆ˜ $$z$$ì— ì˜ì¡´í•˜ëŠ” í™•ë¥ ë³€ìˆ˜ $$x$$ê°€ ìžˆê³  $$z$$ëŠ” ê´€ì¸¡ ë¶ˆê°€ëŠ¥í•˜ë©° $$x$$ë§Œ ê´€ì¸¡í•  ìˆ˜ ìžˆëŠ” ê²½ìš° í™•ë¥ ë¶„í¬ $$p(x)$$ë¥¼ ì¶”ì •í•˜ëŠ” ë°©ë²•ì´ë‹¤. 
______

### ê°€ìš°ì‹œì•ˆ í˜¼í•© ëª¨í˜•

K-í´ëž˜ìŠ¤ ì¹´í…Œê³ ë¦¬ í™•ë¥ ë³€ìˆ˜ Zê°€ ìžˆë‹¤ê³  í•˜ìž. í™•ë¥  ë¶„í¬í•¨ìˆ˜ëŠ” $$p(z=k)=\pi_k$$ ì´ë‹¤. ì‹¤ìˆ˜ê°’ì„ ì¶œë ¥í•˜ëŠ” í™•ë¥ ë³€ìˆ˜ XëŠ” í™•ë¥ ë³€ìˆ˜ Zì˜ í‘œë³¸ê°’ kì— ë”°ë¼ ê¸°ëŒ“ê°’ $$\mu_k$$ , ë¶„ì‚° $$\sigma_k$$ ì´ ë‹¬ë¼ì§„ë‹¤. 
$$
p(x|z)=\mathcal{N}(x|\mu_k, \sigma_k)
$$

ì´ë¥¼ ê²°í•©í•˜ë©´ $$p(x) = \sum_Z p(z)p(x\mid z) = \sum_{k=1}^{K} \pi_k \mathcal{N}(x \mid \mu_k, \Sigma_k)$$ì´ ëœë‹¤. 

ì‹¤ìˆ˜ê°’ì„ ì¶œë ¥í•˜ëŠ” í™•ë¥ ë³€ìˆ˜ Xê°€ K-í´ëž˜ìŠ¤ ì¹´í…Œê³ ë¦¬ í™•ë¥ ë³€ìˆ˜ Zì˜ ê°’ì— ë”°ë¼ ë‹¤ë¥¸ ê¸°ëŒ“ê°’ê³¼ ë¶„ì‚°ì„ ê°€ì§€ëŠ” ë³µìˆ˜ì˜ ê°€ìš°ì‹œì•ˆ ì •ê·œë¶„í¬ë“¤ë¡œ ì´ë£¨ì–´ì§„ ëª¨í˜•ì„ ê°€ìš°ì‹œì•ˆ í˜¼í•© ëª¨í˜•(Gaussian Mixture) ëª¨í˜•ì´ë¼ê³  í•œë‹¤. 

ë‹¨ ê°€ìš°ì‹œì•ˆ í˜¼í•©ëª¨í˜•ì—ì„œ ì¹´í…Œê³ ë¦¬ í™•ë¥ ë³€ìˆ˜ Zì˜ ê°’ì„ ì•Œ ìˆ˜ê°€ ì—†ë‹¤. ì¦‰ ê´€ì¸¡ë˜ì§€ ì•ŠëŠ”ë‹¤ê³  ê°€ì •í•œë‹¤. ì´ë ‡ê²Œ ê´€ì¸¡ ë°ì´í„°ê°€ ë³´ì´ì§€ ì•ŠëŠ” ì¦‰, ë‚´ë¶€ì— ìˆ¨ê²¨ì§„(latent) í™•ë¥  ë³€ìˆ˜ë¥¼ í¬í•¨í•˜ëŠ” ëª¨í˜•ì„ ìž ìž¬ë³€ìˆ˜ëª¨í˜•(latent variable model)ì´ë¼ê³  í•œë‹¤. ìž ìž¬ë³€ìˆ˜ëŠ” í˜¼í•©ëª¨í˜• ì²˜ëŸ¼ ì¹´í…Œê³ ë¦¬ê°’ì´ ë  ìˆ˜ë„ ìžˆê³  ë‹¤ë¥¸ ëª¨í˜•ì—ì„œëŠ” ì‹¤ìˆ˜ê°’ë„ ë  ìˆ˜ ìžˆë‹¤.

### ë² ë¥´ëˆ„ì´ - ê°€ìš°ì‹œì•ˆ í˜¼í•© ëª¨í˜•

ì¹´í…Œê³ ë¦¬ê°€ ë‘ ê°œì¸ ê°€ìš°ì‹œì•ˆ í˜¼í•©ëª¨í˜•ì€ ë² ë¥´ëˆ„ì´-ê°€ìš°ì‹œì•ˆ í˜¼í•©ëª¨í˜•ì´ë¼ê³  í•œë‹¤.

![image-20200308234020856](../../../resource/img/image-20200308234020856.png)

### ê°€ìš°ì‹œì•ˆ í˜¼í•©ëª¨í˜•ì˜ ëª¨ìˆ˜ì¶”ì •

ê°€ìš°ì‹œì•ˆ í˜¼í•©ëª¨í˜• ëª¨ìˆ˜ì¶”ì •ì€ ê´€ì¸¡ë˜ì§€ ì•ŠëŠ” ì¹´í…Œê³ ë¦¬ ë¶„í¬ì˜ í™•ë¥ ë¶„í¬ì™€ ê°ê°ì˜ ì¹´í…Œê³ ë¦¬ì—ì„œì˜ ê°€ìš°ì‹œì•ˆ ì •ê·œë¶„í¬ ëª¨ìˆ˜ë¥¼ ì¶”ì •í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤. 

Nê°œì˜ ë°ì´í„°ì— ëŒ€í•œ Xì˜ í™•ë¥ ë¶„í¬ëŠ”

$$
p(x) = \prod_{i=1}^N p(x_i) = \prod_{i=1}^N \sum_{z_i} p(x_i,z_i) = \prod_{i=1}^N \sum_{z_i} p(z_i)p(x_i\mid z_i)  = \prod_{i=1}^N \sum_{k=1}^{K} \pi_k \mathcal{N}(x_i\mid \mu_k, \Sigma_k)
$$

ë¡œê·¸ë¥¼ ì·¨í•˜ë©´

$$
\log p(x) = \sum_{i=1}^N \log \left( \sum_{k=1}^{K} \pi_k \mathcal{N}(x_i\mid \mu_k, \Sigma_k) \right)
$$

ë‘ ì‹ ëª¨ë‘ ë¯¸ë¶„ê°’ì´ 0ì´ ë˜ëŠ” ëª¨ìˆ˜ê°’ì„ ì‰½ê²Œ êµ¬í•  ìˆ˜ ì—†ë‹¤. 

ë§Œì•½ ë°ì´í„° $$x_i$$ê°€ ì–´ë–¤ ì¹´í…Œê³ ë¦¬ $$z_i$$ì— ì†í•˜ëŠ”ì§€ë¥¼ ì•ˆë‹¤ë©´ ê°™ì€ ì¹´í…Œê³ ë¦¬ì— ì†í•˜ëŠ” ë°ì´í„°ë§Œ ëª¨ì•„ì„œ ì¹´í…Œê³ ë¦¬ í™•ë¥ ë¶„í¬ $$\pi_k$$ë„ ì•Œ ìˆ˜ ìžˆê³  ê°€ìš°ì‹œì•ˆ ì •ê·œë¶„í¬ì˜ ëª¨ìˆ˜ $$\mu_k, \Sigma_k$$ë„ ì‰½ê²Œ êµ¬í•  ìˆ˜ ìžˆì„ ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” ë°ì´í„° $$x_i$$ê°€ ê°€ì§€ê³  ìžˆëŠ” ì¹´í…Œê³ ë¦¬ ê°’ $$z_i$$ë¥¼ ì•Œ ìˆ˜ê°€ ì—†ê¸° ë•Œë¬¸ì— ìœ„ í™•ë¥ ë¶„í¬í•¨ìˆ˜ $$p(x)$$ë¥¼ ìµœëŒ€í™”í•˜ëŠ” $$\pi_k$$ì™€ ðœ‡ð‘˜,$$\mu_k, \Sigma_k$$ë¥¼ ë¹„ì„ í˜• ìµœì í™”ë¥¼ í†µí•´ êµ¬í•´ì•¼ í•œë‹¤.

ë„¤íŠ¸ì›Œí¬ í™•ë¥ ëª¨í˜• ê´€ì ì—ì„œëŠ” í™•ë¥ ë³€ìˆ˜ $$Z_i$$ê°€ í™•ë¥ ë³€ìˆ˜ $$X_i$$ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ë‹¨ìˆœí•œ ëª¨í˜•ì´ë‹¤. ë‹¤ë§Œ $$i=1,\dots,N$$ì¸ ëª¨ë“  ê²½ìš°ì— ëŒ€í•´ ë°˜ë³µì ìœ¼ë¡œ ì˜í–‰ì„ ë¯¸ì¹˜ë¯€ë¡œ ì´ë¥¼ ë‹¤ìŒê³¼ ê°™ì€ íŒë„¬ ëª¨í˜•ìœ¼ë¡œ í‘œí˜„í•œë‹¤.

![image-20200308235252247](../../../resource/img/image-20200308235252247.png)

### EM(Expectation-Maximization)

í˜¼í•©ëª¨í˜•ì˜ ëª¨ìˆ˜ì¶”ì •ì—ì„œ ì¤‘ìš”í•œ ì—­í• ì„ í•˜ëŠ” ê²ƒ ì¤‘ì˜ í•˜ë‚˜ê°€ ë°”ë¡œ ê° ë°ì´í„°ê°€ ì–´ë–¤ ì¹´í…Œê³ ë¦¬ì— ì†í•˜ëŠ”ê°€ë¥¼ ì•Œë ¤ì£¼ëŠ” ì¡°ê±´ë¶€ í™•ë¥  $$p(zâˆ£x)$$ ê°’ì´ë‹¤. ì´ ê°’ì„ responsibilityë¼ê³  í•œë‹¤.

$$
\begin{eqnarray}
\pi_{ik} 
&=& p(z_i=k\mid x_i) \\
&=& \dfrac{p(z_i=k)p(x_i\mid z_i=k)}{p(x_i)} \\
&=& \dfrac{p(z_i=k)p(x_i\mid z_i=k)}{\sum_{k=1}^K p(x_i,z_i=k)} \\
&=& \dfrac{p(z_i=k)p(x_i\mid z_i=k)}{\sum_{k=1}^K p(z_i=k)p(x_i\mid z_i=k)} 
\end{eqnarray}
$$

ê°€ìš°ì‹œì•ˆ í˜¼í•©ëª¨í˜•ì˜ ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ ì •ë¦¬í•  ìˆ˜ ìžˆë‹¤.

$$
\pi_{ik} = \dfrac{\pi_k \mathcal{N}(x_i\mid \mu_k, \Sigma_k)}{\sum_{k=1}^K \pi_k \mathcal{N}(x_i\mid \mu_k, \Sigma_k)}
$$

ì´ ì‹ì€ ëª¨ìˆ˜ë¡œë¶€í„° responsibilityë¥¼ ì¶”ì •í•œë‹¤. 
- $$\pi_{i,k}$$ ëŠ” ië²ˆì§¸ ë°ì´í„° $$x_i$$ ê°€ ì¹´í…Œê³ ë¦¬ $$k$$ ì—ì„œ ë§Œë“¤ì–´ì¡Œì„ í™•ë¥ ì„ ë‚˜íƒ€ë‚¸ë‹¤. 

$$
(\pi_k, \mu_k, \Sigma_k) \;\; \implies \;\; \pi_{ik}
$$

ì´ì œ ë¡œê·¸-ê²°í•©í™•ë¥ ë¶„í¬í•¨ìˆ˜ë¥¼ ìµœëŒ€í™” í•œë‹¤. ìš°ì„  $$\mu_k$$ ë¡œ ë¯¸ë¶„í•˜ì—¬ 0ì´ ë˜ë„ë¡ í•˜ëŠ” ë°©ì •ì‹ì„ ë§Œë“¤ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤. 

$$
0 = - \sum_{i=1}^N \dfrac{p(z_i=k)p(x_i\mid z_i=k)}{\sum_{k=1}^K p(z_i=k)p(x_i\mid z_i=k)} \Sigma_k (x_i - \mu_k )
$$

ì´ë¥¼ ì •ë¦¬í•˜ë©´

$$
\sum_{i=1}^N \pi_{ik} (x_i - \mu_k ) = 0 \\
\mu_k = \dfrac{1}{N_k} \sum_{i=1}^N \pi_{ik} x_i \\
N_k = \sum_{i=1}^N \pi_{ik}
$$

k ì¹´í…Œê³ ë¦¬ì— ì†í•˜ëŠ” ë°ì´í„°ì˜ ìˆ˜ì™€ ë¹„ìŠ·í•œ ì˜ë¯¸ë¥¼ ê°€ì§„ë‹¤. ì¦‰ $$\mu_k$$ ëŠ” kì¹´í…Œê³ ë¦¬ì— ì†í•˜ëŠ” ë°ì´í„°ì˜ ìƒ˜í”Œ í‰ê· ê³¼ ê°™ì€ ì˜ë¯¸ì´ë‹¤. 

ë§ˆì°¬ê°€ì§€ë¡œ ë¡œê·¸-ê²°í•©í™•ë¥ ë¶„í¬í•¨ìˆ˜ë¥¼ Î£ð‘˜Î£kë¡œ ë¯¸ë¶„í•˜ì—¬ ìµœëŒ€í™”í•˜ëŠ” ëª¨ìˆ˜ê°’ì„ êµ¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\Sigma_k = \dfrac{1}{N_k} \sum_{i=1}^N \pi_{ik} (x_i-\mu_k)(x_i-\mu_k)^T
$$

ë§ˆì§€ë§‰ìœ¼ë¡œ ë¡œê·¸-ê²°í•©í™•ë¥ ë¶„í¬í•¨ìˆ˜ë¥¼ $$\pi_k$$ë¡œ ë¯¸ë¶„í•˜ì—¬ ìµœëŒ€í™”í•˜ëŠ” ëª¨ìˆ˜ê°’ì„ êµ¬í•´ì•¼ í•˜ëŠ”ë° ì´ ë•Œ ì¹´í…Œê³ ë¦¬ê°’ì˜ ëª¨ìˆ˜ê°€ ê°€ì§€ëŠ” ì œí•œ ì¡°ê±´ìœ¼ë¡œ ì¸í•´ Lagrange multiplier ë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤.

$$
\log p(x) + \lambda \left(\sum_{k=1}^K \pi_k - 1 \right)
$$

- ì´ë¥¼ $$\pi_k$$ë¡œ ë¯¸ë¶„í•˜ì—¬ 0ì´ ë˜ëŠ” ê°’ì„ ì°¾ìœ¼ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\pi_k = \dfrac{N_k}{N}
$$

ì´ ì„¸ê°€ì§€ ì‹ì€ ëª¨ë‘ responsibilityë¡œë¶€í„° ëª¨ìˆ˜ë¥¼ êµ¬í•˜ê³  ìžˆë‹¤.  $$\pi_{ik} \;\; \implies \;\; (\pi_k, \mu_k, \Sigma_k )$$

ì›ëž˜ëŠ” ì—°ë¦½ë°©ì •ì‹ì˜ í•´ë¥¼ êµ¬í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ responsibilityë¥¼ í¬í•¨í•œ ëª¨ìˆ˜ê°’ì„ ì¶”ì •í•´ì•¼ í•œë‹¤. ê·¸ëŸ¬ë‚˜ ë§Œì•½ ì‹ì˜ í˜•íƒœê°€ responsibilityë¥¼ ì•Œê³  ìžˆë‹¤ë©´ ëª¨ìˆ˜ë¥¼ ì¶”ì •í•˜ëŠ” ê²ƒì´ ê°„ë‹¨í•˜ë„ë¡ ë§Œë“¤ì–´ì ¸ ìžˆê¸° ë•Œë¬¸ì— EM(Expectation-Maximization)ì´ë¼ê³  í•˜ëŠ” iterative ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ì—°ë¦½ë°©ì •ì‹ì˜ í•´ë¥¼ êµ¬í•˜ëŠ” ê²ƒë³´ë‹¤ ë” ì‰½ê²Œ ëª¨ìˆ˜ë¥¼ ì¶”ì •í•  ìˆ˜ ìžˆë‹¤.

EM ë°©ë²•ì€ ëª¨ìˆ˜ì™€ responsibilityë¥¼ ë²ˆê°ˆì•„ ì¶”ì •í•˜ë©° ì •í™•ë„ë¥¼ ë†’ì—¬ê°€ëŠ” ë°©ë²•ì´ë‹¤.
- E step ì—ì„œëŠ” ìš°ë¦¬ê°€ í˜„ìž¬ê¹Œì§€ ì•Œê³  ìžˆëŠ” ëª¨ìˆ˜ê°€ ì •í™•í•˜ë‹¤ê³  ê°€ì •í•˜ê³  ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ê° ë°ì´í„°ê°€ ì–´ëŠ ì¹´í…Œê³ ë¦¬ì— ì†í•˜ëŠ”ì§€ ì¦‰, resposibilityë¥¼ ì¶”ì •í•œë‹¤. 

$$
(\pi_k, \mu_k, \Sigma_k) \;\; \implies \;\; \pi_{ik}
$$

- M step ì—ì„œëŠ” ìš°ë¦¬ê°€ í˜„ìž¬ê¹Œì§€ ì•Œê³  ìžˆëŠ” responsibilityê°€ ì •í™•í•˜ë‹¤ê³  ê°€ì •í•˜ê³  ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ìˆ˜ê°’ì„ ì¶”ì •í•œë‹¤. 

$$
\pi_{ik} \;\; \implies \;\; (\pi_k, \mu_k, \Sigma_k)
$$

- ì´ë¥¼ ë°˜ë³µí•˜ë©´ ëª¨ìˆ˜ì™€ responsibilityë¥¼ ë™ì‹œì— ì ì§„ì ìœ¼ë¡œ ê°œì„ í•  ìˆ˜ ìžˆë‹¤.

### í´ëŸ¬ìŠ¤í„°ë§

ê°ê°ì˜ ë°ì´í„°ì— ëŒ€í•´ responsibilityì„ ì•Œê²Œë˜ë©´ responsibilityê°€ ê°€ìž¥ í° ì¹´í…Œê³ ë¦¬ë¥¼ ì°¾ì•„ë‚´ì–´ ê·¸ ë°ì´í„°ê°€ ì–´ë–¤ ì¹´í…Œê³ ë¦¬ì— ì†í•˜ëŠ”ì§€ë¥¼ ì•Œ ìˆ˜ ìžˆë‹¤. ì¦‰ í´ëŸ¬ìŠ¤í„°ë§ì„ í•  ìˆ˜ ìžˆë‹¤.

$$
k_i = \arg\max_{k} \pi_{ik}
$$

ì‚¬ì‹¤ K-means clusteringì€ EM ë°©ë²•ì˜ íŠ¹ìˆ˜í•œ ê²½ìš°ë¼ê³  ë³¼ ìˆ˜ ìžˆë‹¤.

### ì¼ë°˜ì  EM ì•Œê³ ë¦¬ì¦˜

EM ì•Œê³ ë¦¬ì¦˜ì€ ìž ìž¬ë³€ìˆ˜ $$z$$ì— ì˜ì¡´í•˜ëŠ” í™•ë¥ ë³€ìˆ˜ $$x$$ê°€ ìžˆê³  $$z$$ëŠ” ê´€ì¸¡ ë¶ˆê°€ëŠ¥í•˜ë©° $$x$$ë§Œ ê´€ì¸¡í•  ìˆ˜ ìžˆëŠ” ê²½ìš° í™•ë¥ ë¶„í¬ $$p(x)$$ë¥¼ ì¶”ì •í•˜ëŠ” ë°©ë²•ì´ë‹¤. ë‹¤ë§Œ ë„¤íŠ¸ì›Œí¬ ëª¨í˜•ì— ì˜í•´ ì¡°ê±´ë¶€í™•ë¥ ë¶„í¬ $$p(xâˆ£z,Î¸)$$ëŠ” ëª¨ìˆ˜ $$\theta$$ì— ì˜í•´ ê²°ì •ë˜ë©° ê·¸ ìˆ˜ì‹ì€ ì•Œê³  ìžˆë‹¤ê³  ê°€ì •í•œë‹¤.

í˜¼í•©ëª¨í˜•ì˜ ê²½ìš°ì—ëŠ” $$z$$ê°€ ì´ì‚°í™•ë¥ ë³€ìˆ˜ì´ë¯€ë¡œ
- $$p(x \mid  \theta) $$ ìŒë´‰ì´ê³ , $$p(x\mid z, \theta)$$ ë‹¨ë´‰ì´ë‹¤. $$\theta$$ ëŠ” x ë¶„í¬ê°€ ì–´ë–¤ ëª¨ì–‘ì„ ë‚˜íƒ€ë‚´ëŠ” íŒŒë¼ë¯¸í„° ì´ë‹¤. 

$$
p(x \mid  \theta) = \sum_z p(x, z \mid  \theta) = \sum_z q(z) p(x\mid z, \theta)
$$

ì£¼ì–´ì§„ ë°ì´í„° $$x$$ì— ëŒ€í•´ ê°€ëŠ¥ë„ $$p(xâˆ£Î¸)$$ë¥¼ ê°€ìž¥ í¬ê²Œ í•˜ëŠ” ìž ìž¬ë³€ìˆ˜ì— ëŒ€í•œ í™•ë¥ ë¶„í¬ $$q(z)$$ì™€ $$\theta$$ë¥¼ êµ¬í•˜ëŠ” ê²ƒì´ EM ì•Œê³ ë¦¬ì¦˜ì˜ ëª©í‘œì´ë‹¤.

$$
\log p(x) = 
\sum_z q(z) \log \left(\dfrac{p(x, z \mid  \theta)}{q(z)}\right) -
\sum_z q(z) \log \left(\dfrac{p(z\mid x,  \theta)}{q(z)}\right)
$$

$$
L(q, \theta) = 
\sum_z q(z) \log \left(\dfrac{P(x, z \mid  \theta)}{q(z)}\right) \\
KL(q \mid  p) = 
-\sum_z q(z) \log \left(\dfrac{p(z\mid x,  \theta)}{q(z)}\right) \\
\log p(x) = L(q, \theta) + KL(q \mid  p)
$$

$$logp(x)$$ ì—ì„œ $$p$$ ëŠ” ìš°ë¦¬ê°€ êµ¬ë¼í˜€ë¥¼ likelihood ì´ê³  $$KL(q|p)$$ ì—ì„œ pëŠ” zì— ëŒ€í•œ likelihood ê°’ì´ë‹¤. 

EM ì•Œê³ ë¦¬ì¦˜ì€ $$L(q,Î¸)$$ë¥¼ ìµœëŒ€í™”í•˜ê¸°ìœ„í•´ $$q$$ì™€ $$\theta$$ì˜ ìµœì ê°’ì„ êµëŒ€ë¡œ ì°¾ì•„ë‚¸ë‹¤.

(1) E ë‹¨ê³„ì—ì„œëŠ” $$\theta$$ ë¥¼ í˜„ìž¬ì˜ ê°’ $$\theta old$$ìœ¼ë¡œ ê³ ì •ì‹œí‚¤ê³  $$ð¿(ð‘žold,ðœƒold)$$ë¥¼ ìµœëŒ€í™”í•˜ëŠ” $$qnew$$ë¥¼ ì°¾ëŠ”ë‹¤. ë§žê²Œ ì°¾ì•˜ë‹¤ë©´ $$L(q_{\text{new}}, \theta_\text{old})$$ëŠ” ìƒí•œì¸ $$logâ¡p(x)$$ì™€ ê°™ì•„ì§„ë‹¤. ì¦‰ ì¿¨ë°±-ë¼ì´ë¸”ëŸ¬ ë°œì‚°ì€ 0ì´ëœë‹¤.

$$
L(q_{\text{new}}, \theta_\text{old}) = \log p(x) \\ 
KL(q_{\text{new}} \mid  p) = 0 \\
q_{\text{new}} = p(z\mid x, \theta_{\text{old}})
$$
    
(2) M ë‹¨ê³„ì—ì„œëŠ” $$q$$ë¥¼ í˜„ìž¬ì˜ í•¨ìˆ˜ $$qnew$$ë¡œ ê³ ì •ì‹œí‚¤ê³  $$L(qnew,Î¸)$$ë¥¼ ìµœëŒ€í™”í•˜ëŠ” $$Î¸new$$ê°’ì„ ì°¾ëŠ”ë‹¤. ìµœëŒ€í™”ë¥¼ í•˜ì˜€ìœ¼ë¯€ë¡œ ë‹¹ì—°ížˆ $$L(qnew,Î¸new)$$ëŠ” ì˜›ë‚  ê°’ë³´ë‹¤ ì»¤ì§„ë‹¤.

$$
L(q_{\text{new}}, \theta_{\text{new}}) > L(q_{\text{new}}, \theta_{\text{old}})
$$

ê·¸ë¦¬ê³  ë™ì‹œì— $$p(Z\mid X, \theta_{\text{new}})$$ì´ ê³¼ê±°ì˜ ê°’ $$p(Z\mid X, \theta_{\text{old}})$$ê³¼ ë‹¬ë¼ì¡Œìœ¼ë¯€ë¡œ $$qnew$$ëŠ” $$p(Z\mid X, \theta_{\text{new}})$$ì™€ ë‹¬ë¼ì§„ë‹¤. ê·¸ëŸ¬ë©´ ì¿¨ë°± ë¼ì´ë¸”ëŸ¬ ë°œì‚°ì˜ ê°’ë„ 0ë³´ë‹¤ ì»¤ì§€ê²Œ ëœë‹¤.

$$
q_{\text{new}} \neq p(Z\mid X, \theta_{\text{new}}) \\
KL(q_{\text{new}} \mid  p) > 0
$$