# Affinity Propagation

### Summary

- Affinity Propagation은 모든 데이터가 특정한 기준에 따라 자신을 대표할 데이터를 선택한다. 만약 스스로가 자기 자신을 대표하게 되면 클러스터의 중심이 된다. k-median 방법과 비슷하다. k를 정해주는게 아니라 다른 하이퍼파라미터를 정해준다. 나랑 제일 닮은 애(similality)를 대표로 선택한다. 대표특징은 자기자신에게 투표한다.

------
### Affinity Propagation

Affinity Propagation은 모든 데이터가 특정한 기준에 따라 자신을 대표할 대표 데이터를 선택한다. 만약 스스로가 자기 자신을 대표하게 되면 클러스터의 중심이 된다.

- responsibility $$r(i, k)$$ : $$k$$ 번째 데이터가 $$i$$ 번째 데이터의 대표가 되어야 한다는 근거이다.
- availability $$a(i, k)$$ : $$i$$ 번째 데이터가 $$k$$ 번쨰 데이터를 대표로 선택해야 한다는 근거이다.

다음 수식을 수렴할 때까지 반복한다.

$$
r(i, k) \leftarrow s(i, k) - \max_{k' \neq k} ( a(i, k') + s(i, k')) \\
a(i, k) \leftarrow \min(0, r(k, k) + \sum_{i' \neq i,k} r(i', k))
$$

여기에서 $$s(i, k)$$ 는 다음과 같이 음의 거리로 정의되는 유사도이다. 

$$
s(i,k) = -|| x_i - x_k ||^2
$$

특히 $$s(k, k)$$ 는 특정한 음수 값으로 사용자가 정해 주게 되는데 이 값에 따라서 클러스터의 갯수가 달라지는 하이퍼모수가 된다. $$s(k, k)$$ 가 크면 자기 자신에 대한 유사도가 커져서 클러스터의 수가 증가한다. 

위 알고리즘으로 계산하는 $$r, a$$ 가 더 이상 변화하지 않고 수렴하면 계산이 종료되고 종료 시점에서 $$r(k,k)+a(k,k) >0$$ 이 데이터가 클러스터의 중심이 된다.

  